

PLAY [all] *********************************************************************

TASK [Gathering Facts] *********************************************************
[0;32mok: [node][0m

TASK [RHEL9-CIS : Check OS version and family] *********************************
[0;32mok: [node] => {[0m
[0;32m    "changed": false,[0m
[0;32m    "msg": "This role is running against a supported OS OracleLinux 9"[0m
[0;32m}[0m

TASK [RHEL9-CIS : Check ansible version] ***************************************
[0;32mok: [node] => {[0m
[0;32m    "changed": false,[0m
[0;32m    "msg": "This role is running a supported version of ansible 2.17.3 >= 2.10.1"[0m
[0;32m}[0m

TASK [RHEL9-CIS : Check password set for {{ ansible_env.SUDO_USER }} | password state] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Check for local account {{ ansible_env.SUDO_USER }} | Check for local account] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Check password set for {{ ansible_env.SUDO_USER }} | Assert local password set] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Check account is not locked for {{ ansible_env.SUDO_USER }} | Assert local account not locked] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Ensure root password is set] *********************************
[0;31mfatal: [node]: FAILED! => {"changed": false, "cmd": "passwd -S root | egrep -e \"(Password set, SHA512 crypt|Password locked)\"", "delta": "0:00:00.007634", "end": "2024-09-24 16:06:37.927358", "msg": "non-zero return code", "rc": 1, "start": "2024-09-24 16:06:37.919724", "stderr": "Only root can do that.", "stderr_lines": ["Only root can do that."], "stdout": "", "stdout_lines": []}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : Ensure root password is set] *********************************
[0;31mfatal: [node]: FAILED! => {[0m
[0;31m    "assertion": "root_passwd_set.rc == 0",[0m
[0;31m    "changed": false,[0m
[0;31m    "evaluated_to": false,[0m
[0;31m    "msg": "You have rule 5.6.6 enabled this requires that you have a root password set"[0m
[0;31m}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : Discover and set container variable if required] *************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Load variable for container] *********************************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Output if discovered is a container] *************************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Check crypto-policy input] ***********************************
[0;32mok: [node] => {[0m
[0;32m    "changed": false,[0m
[0;32m    "msg": "Crypto policy is a permitted version"[0m
[0;32m}[0m

TASK [RHEL9-CIS : Check crypto-policy module input] ****************************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Check rhel9cis_bootloader_password_hash variable has been changed] ***
[0;31mfatal: [node]: FAILED! => {[0m
[0;31m    "assertion": "rhel9cis_bootloader_password_hash.find('grub.pbkdf2.sha512') != -1 and rhel9cis_bootloader_password_hash != 'grub.pbkdf2.sha512.changethispassword'",[0m
[0;31m    "changed": false,[0m
[0;31m    "evaluated_to": false,[0m
[0;31m    "msg": "This role will not be able to run single user password commands as rhel9cis_bootloader_password_hash variable has not been set correctly"[0m
[0;31m}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : Gather the package facts] ************************************
[0;32mok: [node][0m

TASK [RHEL9-CIS : Include OS specific variables] *******************************
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Include audit specific variables] *******************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit Setup | Setup the LE audit] ************************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit Setup | Ensure {{ audit_conf_dir }} exists] ********
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit Setup | Install git] *******************************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit Setup | Retrieve audit content files from git] *****
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit Setup | Copy to audit content files to server] *****
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit Setup | Unarchive audit content files on server] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit Setup | Get audit content from url] ****************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit Setup | Check for goss file] ***********************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit Setup | If audit ensure goss is available] *********
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit Setup | Copy ansible default vars values to test audit] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit | Run pre_remediation RHEL9-CIS audit] *************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit | Capture audit data if json format] ***************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit | Set Fact for audit summary] **********************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit | Capture audit data if documentation format] ******
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit | Set Fact for audit summary] **********************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Audit_Only | Create local Directories for hosts] *************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Audit_only | Get audits from systems and put in group dir] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Audit_only | Show Audit Summary] *****************************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Audit_only | Stop Playbook Audit Only selected] **************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : PRELIM | AUDIT | Interactive Users] **************************
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | AUDIT | Interactive User accounts home directories] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | AUDIT | Interactive UIDs] ***************************
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | capture /etc/password variables] ********************
[0;36mincluded: /Users/meesam/.ansible/roles/RHEL9-CIS/tasks/parse_etc_password.yml for node[0m

TASK [RHEL9-CIS : PRELIM | 5.5.2 | 6.2.7 | 6.2.8 | 6.2.20 | Parse /etc/passwd] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | 5.5.2 | 6.2.7 | 6.2.8 | 6.2.20 | Split passwd entries] ***
[0;32mok: [node] => (item=root:x:0:0:root:/root:/bin/bash)[0m
[0;32mok: [node] => (item=bin:x:1:1:bin:/bin:/sbin/nologin)[0m
[0;32mok: [node] => (item=daemon:x:2:2:daemon:/sbin:/sbin/nologin)[0m
[0;32mok: [node] => (item=adm:x:3:4:adm:/var/adm:/sbin/nologin)[0m
[0;32mok: [node] => (item=lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin)[0m
[0;32mok: [node] => (item=sync:x:5:0:sync:/sbin:/bin/sync)[0m
[0;32mok: [node] => (item=shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown)[0m
[0;32mok: [node] => (item=halt:x:7:0:halt:/sbin:/sbin/halt)[0m
[0;32mok: [node] => (item=mail:x:8:12:mail:/var/spool/mail:/sbin/nologin)[0m
[0;32mok: [node] => (item=operator:x:11:0:operator:/root:/sbin/nologin)[0m
[0;32mok: [node] => (item=games:x:12:100:games:/usr/games:/sbin/nologin)[0m
[0;32mok: [node] => (item=ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin)[0m
[0;32mok: [node] => (item=nobody:x:65534:65534:Kernel Overflow User:/:/sbin/nologin)[0m
[0;32mok: [node] => (item=dbus:x:81:81:System message bus:/:/sbin/nologin)[0m
[0;32mok: [node] => (item=systemd-coredump:x:999:997:systemd Core Dumper:/:/sbin/nologin)[0m
[0;32mok: [node] => (item=systemd-resolve:x:193:193:systemd Resolver:/:/sbin/nologin)[0m
[0;32mok: [node] => (item=tss:x:59:59:Account used for TPM access:/dev/null:/sbin/nologin)[0m
[0;32mok: [node] => (item=polkitd:x:998:996:User for polkitd:/:/sbin/nologin)[0m
[0;32mok: [node] => (item=unbound:x:997:994:Unbound DNS resolver:/etc/unbound:/sbin/nologin)[0m
[0;32mok: [node] => (item=sssd:x:996:993:User for sssd:/:/sbin/nologin)[0m
[0;32mok: [node] => (item=chrony:x:995:992::/var/lib/chrony:/sbin/nologin)[0m
[0;32mok: [node] => (item=sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin)[0m
[0;32mok: [node] => (item=ec2-user:x:1000:1000:ec2-user:/home/ec2-user:/bin/bash)[0m
[0;32mok: [node] => (item=systemd-oom:x:990:990:systemd Userspace OOM Killer:/:/usr/sbin/nologin)[0m
[0;32mok: [node] => (item=test:x:1001:1001::/home/test:/bin/bash)[0m

TASK [RHEL9-CIS : PRELIM | List users accounts] ********************************
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Gather accounts with empty password fields] *********
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Gather UID 0 accounts other than root] **************
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Install crypto-policies | pkgs present] *************
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "This command has to be run under the root user.", "results": []}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : PRELIM | Gather system-wide crypto-policy] *******************
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Gather system-wide crypto-policy | set fact system policy] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Gather system-wide crypto-policy module | set fact system policy submodule] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : PRELIM | if systemd coredump] ********************************
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Section 1.1 | Create list of mount points] **********
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Ensure python3-libselinux is installed] *************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : PRELIM | Check whether machine is UEFI-based] ****************
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | set legacy boot and grub path | Bios] ***************
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | set grub fact | UEFI] *******************************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : PRELIM | Update to latest gpg keys] **************************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : PRELIM | Check gpg keys are imported will cause 1.2.1 to fail if not] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : PRELIM | Check key package matches RedHat] *******************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : PRELIM | Force keys to be imported] **************************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : PRELIM | Section 4.1 | Configure System Accounting (auditd)] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | 4.1.4.5 | Audit conf and rules files | list files] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Section 5.1 | Configure cron] ***********************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : PRELIM | Section 5.2 | SSH] **********************************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : PRELIM | 5.3.4 | Find all sudoers files.] ********************
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Capture UID_MIN information from logins.def] ********
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Capture UID_MAX information from logins.def] ********
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Capture GID_MIN information from logins.def] ********
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | set_facts for interactive uid/gid] ******************
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Output of uid findings] *****************************
[0;32mok: [node] => {[0m
[0;32m    "msg": "1000 60000"[0m
[0;32m}[0m

TASK [RHEL9-CIS : PRELIM | Gather the package facts after prelim] **************
[0;32mok: [node][0m

TASK [RHEL9-CIS : 1.1.1.1 | PATCH | Ensure mounting of squashfs filesystems is disabled | Edit modprobe config] ***
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 13] Permission denied: b'/home/ec2-user/.ansible/tmp/ansible-tmp-1727208489.339668-42947-225371687310723/tmp8xguz3ar' -> b'/etc/modprobe.d/CIS.conf'[0m
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "The destination directory (/etc/modprobe.d) is not writable by the current user. Error was: [Errno 13] Permission denied: b'/etc/modprobe.d/.ansible_tmp0u61lb5lCIS.conf'"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.1.1.1 | PATCH | Ensure mounting of squashfs filesystems is disabled | blacklist] ***
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 13] Permission denied: b'/home/ec2-user/.ansible/tmp/ansible-tmp-1727208491.250858-42956-167463963839257/tmp55j7e2es' -> b'/etc/modprobe.d/blacklist.conf'[0m
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "The destination directory (/etc/modprobe.d) is not writable by the current user. Error was: [Errno 13] Permission denied: b'/etc/modprobe.d/.ansible_tmpd6tgomv7blacklist.conf'"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.1.1.1 | PATCH | Ensure mounting of squashfs filesystems is disabled | Disable squashfs] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 1.1.1.2 | PATCH | Ensure mounting of udf filesystems is disable | Edit modprobe config] ***
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 13] Permission denied: b'/home/ec2-user/.ansible/tmp/ansible-tmp-1727208494.768481-42984-154506213089398/tmpwaf2wtum' -> b'/etc/modprobe.d/CIS.conf'[0m
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "The destination directory (/etc/modprobe.d) is not writable by the current user. Error was: [Errno 13] Permission denied: b'/etc/modprobe.d/.ansible_tmp2b47uckmCIS.conf'"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.1.1.2 | PATCH | Ensure mounting of udf filesystems is disabled | blacklist] ***
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 13] Permission denied: b'/home/ec2-user/.ansible/tmp/ansible-tmp-1727208496.476665-42996-220782652779349/tmpz0t0479o' -> b'/etc/modprobe.d/blacklist.conf'[0m
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "The destination directory (/etc/modprobe.d) is not writable by the current user. Error was: [Errno 13] Permission denied: b'/etc/modprobe.d/.ansible_tmpkwewxmpnblacklist.conf'"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.1.1.2 | PATCH | Ensure mounting of udf filesystems is disable | Disable udf] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 1.1.2.1 | PATCH | Ensure /tmp is a separate partition | Absent] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": "Warning!! /tmp doesn't exist. This is a manual task"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 1.1.2.1 | AUDIT | Set fact for manual task warning.] *********
[0;32mok: [node][0m

TASK [RHEL9-CIS : "1.1.2.2 | PATCH | Ensure nodev option set on /tmp partition"
"1.1.2.3 | PATCH | Ensure noexec option set on /tmp partition"
"1.1.2.4 | PATCH | Ensure nosuid option set on /tmp partition"] ***
[0;36mskipping: [node] => (item=/dev/mapper/ol-root) [0m
[0;36mskipping: [node] => (item=/dev/nvme0n1p2) [0m
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : "1.1.2.1 | PATCH | Ensure /tmp is configured"
"1.1.2.2 | PATCH | Ensure nodev option set on /tmp partition"
"1.1.2.3 | PATCH | Ensure noexec option set on /tmp partition"
"1.1.2.4 | PATCH | Ensure nosuid option set on /tmp partition"] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.1.3.1 | AUDIT | Ensure separate partition exists for /var | Absent] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": "Warning!! /var doesn't exist. This is a manual task"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 1.1.3.1 | AUDIT | Set fact for manual task warning.] *********
[0;32mok: [node][0m

TASK [RHEL9-CIS : "1.1.3.2 | PATCH | Ensure nodev option set on /var partition"
"1.1.3.3 | PATCH | Ensure nosuid option set on /var partition"] ***
[0;36mskipping: [node] => (item=/dev/mapper/ol-root) [0m
[0;36mskipping: [node] => (item=/dev/nvme0n1p2) [0m
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.1.4.1 | AUDIT | Ensure separate partition exists for /var/tmp | Absent] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": "Warning!! /var/tmp doesn't exist. This is a manual task"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 1.1.4.1 | AUDIT | Set fact for manual task warning.] *********
[0;32mok: [node][0m

TASK [RHEL9-CIS : "1.1.4.2 | PATCH | Ensure noexec option set on /var/tmp partition"
"1.1.4.3 | PATCH | Ensure nosuid option set on /var/tmp partition"
"1.1.4.4 | PATCH | Ensure nodev option set on /var/tmp partition"] ***
[0;36mskipping: [node] => (item=/dev/mapper/ol-root) [0m
[0;36mskipping: [node] => (item=/dev/nvme0n1p2) [0m
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.1.5.1 | AUDIT | Ensure separate partition exists for /var/log | Absent] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": "Warning!! /var/log doesn't exist. This is a manual task"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 1.1.5.1 | AUDIT | Set fact for manual task warning.] *********
[0;32mok: [node][0m

TASK [RHEL9-CIS : "1.1.5.2 | PATCH | Ensure nodev option set on /var/log partition"
"1.1.5.3 | PATCH | Ensure noexec option set on /var/log partition"
"1.1.5.4 | PATCH | Ensure nosuid option set on /var/log partition"] ***
[0;36mskipping: [node] => (item=/dev/mapper/ol-root) [0m
[0;36mskipping: [node] => (item=/dev/nvme0n1p2) [0m
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.1.6.1 | AUDIT | Ensure separate partition exists for /var/log/audit | Absent] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": "Warning!! /var/log/audit doesn't exist. This is a manual task"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 1.1.6.1 | AUDIT | Set fact for manual task warning.] *********
[0;32mok: [node][0m

TASK [RHEL9-CIS : "1.1.6.2 | PATCH | Ensure noexec option set on /var/log/audit partition"
"1.1.6.3 | PATCH | Ensure nodev option set on /var/log/audit partition"
"1.1.6.4 | PATCH | Ensure nosuid option set on /var/log/audit partition"] ***
[0;36mskipping: [node] => (item=/dev/mapper/ol-root) [0m
[0;36mskipping: [node] => (item=/dev/nvme0n1p2) [0m
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.1.7.1 | AUDIT | Ensure separate partition exists for /home | Absent] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": "Warning!! /home doesn't exist. This is a manual task"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 1.1.7.1 | AUDIT | Set fact for manual task warning.] *********
[0;32mok: [node][0m

TASK [RHEL9-CIS : "1.1.7.2 | PATCH | Ensure nodev option set on /home partition
 1.1.7.3 | PATCH | Ensure nosuid option set on /home partition"] ***
[0;36mskipping: [node] => (item=/dev/mapper/ol-root) [0m
[0;36mskipping: [node] => (item=/dev/nvme0n1p2) [0m
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.1.8.1 | AUDIT | Ensure /dev/shm is a separate partition | check exists] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 1.1.8.1 | AUDIT | Ensure /dev/shm is a separate partition | Absent] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.1.8.1 | AUDIT | Set fact for manual task warning.] *********
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : "1.1.8.2 | PATCH | Ensure nodev option set on /dev/shm partition | Set nodev option
 1.1.8.3 | PATCH | Ensure noexec option set on /dev/shm partition | Set nosuid option
 1.1.8.4 | PATCH | Ensure nosuid option set on /dev/shm partition | Set noexec option"] ***
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 13] Permission denied: '/etc/fstab'[0m
[0;31mfatal: [node]: FAILED! => {"changed": false, "module_stderr": "Shared connection to 13.233.97.162 closed.\r\n", "module_stdout": "Traceback (most recent call last):\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727208502.4722939-43050-153381768048878/AnsiballZ_mount.py\", line 107, in <module>\r\n    _ansiballz_main()\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727208502.4722939-43050-153381768048878/AnsiballZ_mount.py\", line 99, in _ansiballz_main\r\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727208502.4722939-43050-153381768048878/AnsiballZ_mount.py\", line 47, in invoke_module\r\n    runpy.run_module(mod_name='ansible_collections.ansible.posix.plugins.modules.mount', init_globals=dict(_module_fqn='ansible_collections.ansible.posix.plugins.modules.mount', _modlib_path=modlib_path),\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 225, in run_module\r\n    return _run_module_code(code, init_globals, run_name, mod_spec)\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 97, in _run_module_code\r\n    _run_code(code, mod_globals, init_globals,\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 87, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/tmp/ansible_ansible.posix.mount_payload_9tj3nxpw/ansible_ansible.posix.mount_payload.zip/ansible_collections/ansible/posix/plugins/modules/mount.py\", line 1008, in <module>\r\n  File \"/tmp/ansible_ansible.posix.mount_payload_9tj3nxpw/ansible_ansible.posix.mount_payload.zip/ansible_collections/ansible/posix/plugins/modules/mount.py\", line 932, in main\r\n  File \"/tmp/ansible_ansible.posix.mount_payload_9tj3nxpw/ansible_ansible.posix.mount_payload.zip/ansible_collections/ansible/posix/plugins/modules/mount.py\", line 365, in _set_mount_save_old\r\n  File \"/tmp/ansible_ansible.posix.mount_payload_9tj3nxpw/ansible_ansible.posix.mount_payload.zip/ansible_collections/ansible/posix/plugins/modules/mount.py\", line 229, in write_fstab\r\nPermissionError: [Errno 13] Permission denied: '/etc/fstab'\r\n", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.1.9 | PATCH | Disable USB Storage | Edit modprobe config] ***
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 13] Permission denied: b'/home/ec2-user/.ansible/tmp/ansible-tmp-1727208504.44561-43061-190370845491623/tmp76nix6eo' -> b'/etc/modprobe.d/CIS.conf'[0m
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "The destination directory (/etc/modprobe.d) is not writable by the current user. Error was: [Errno 13] Permission denied: b'/etc/modprobe.d/.ansible_tmp8838whabCIS.conf'"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.1.9 | PATCH | Disable USB Storage | Edit modprobe config] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 1.1.9 | PATCH | Disable USB Storage | blacklist] *************
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 13] Permission denied: b'/home/ec2-user/.ansible/tmp/ansible-tmp-1727208508.7375948-43084-91966236424942/tmp8iw0nwdz' -> b'/etc/modprobe.d/blacklist.conf'[0m
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "The destination directory (/etc/modprobe.d) is not writable by the current user. Error was: [Errno 13] Permission denied: b'/etc/modprobe.d/.ansible_tmpg9y4ul9pblacklist.conf'"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.2.1 | AUDIT | Ensure GPG keys are configured | list installed pubkey keys] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.2.1 | AUDIT | Ensure GPG keys are configured | Query found keys] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.2.1 | AUDIT | Ensure GPG keys are configured | expected keys fail] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.2.2 | AUDIT | Ensure gpgcheck is globally activated | Find repos] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 1.2.2 | PATCH | Ensure gpgcheck is globally activated | Update yum.repos] ***
[0;32mok: [node] => (item=/etc/yum.repos.d/virt-ol9.repo)[0m
[0;32mok: [node] => (item=/etc/yum.repos.d/oracle-linux-ol9.repo)[0m
[0;32mok: [node] => (item=/etc/yum.repos.d/uek-ol9.repo)[0m

TASK [RHEL9-CIS : 1.2.3 | AUDIT | Ensure package manager repositories are configured | Get repo list] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 1.2.3 | AUDIT | Ensure package manager repositories are configured | Display repo list] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": [[0m
[0;32m        "Warning!! Below are the configured repos. Please review and make sure all align with site policy",[0m
[0;32m        [[0m
[0;32m            "repo id                repo name",[0m
[0;32m            "ol9_UEKR7              Oracle Linux 9 UEK Release 7 (x86_64)",[0m
[0;32m            "ol9_appstream          Oracle Linux 9 Application Stream Packages (x86_64)",[0m
[0;32m            "ol9_baseos_latest      Oracle Linux 9 BaseOS Latest (x86_64)"[0m
[0;32m        ][0m
[0;32m    ][0m
[0;32m}[0m

TASK [RHEL9-CIS : 1.2.3 | AUDIT | Set fact for manual task warning.] ***********
[0;32mok: [node][0m

TASK [RHEL9-CIS : 1.2.4 | PATCH | Ensure repo_gpgcheck is globally activated | dnf.conf] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.2.4 | AUDIT| Ensure repo_gpgcheck is globally activated | get repo files] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.2.4 | PATCH | Ensure repo_gpgcheck is globally activated | amend repo files] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.3.1 | PATCH | Ensure AIDE is installed | Install AIDE] *****
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "This command has to be run under the root user.", "results": []}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.3.1 | PATCH | Ensure AIDE is installed | Build AIDE DB] ****
[0;31mfatal: [node]: FAILED! => {"changed": true, "cmd": "/usr/sbin/aide --init", "delta": "0:00:00.005099", "end": "2024-09-24 16:08:45.112330", "msg": "non-zero return code", "rc": 127, "start": "2024-09-24 16:08:45.107231", "stderr": "/bin/sh: line 1: /usr/sbin/aide: No such file or directory", "stderr_lines": ["/bin/sh: line 1: /usr/sbin/aide: No such file or directory"], "stdout": "", "stdout_lines": []}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.3.1 | PATCH | Ensure AIDE is installed | Wait for file before continuing] ***
[0;31mfatal: [node]: FAILED! => {"changed": false, "elapsed": 300, "msg": "Timeout when waiting for file /var/lib/aide/aide.db.new.gz"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.3.1 | PATCH | Ensure AIDE is installed | copy AIDE DB] *****
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "Source /var/lib/aide/aide.db.new.gz not found"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.3.2 | PATCH | Ensure filesystem integrity is regularly checked] ***
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 13] Permission denied: b'/etc/cron.d/aide_cron'[0m
[0;31mfatal: [node]: FAILED! => {"changed": false, "module_stderr": "Shared connection to 13.233.97.162 closed.\r\n", "module_stdout": "Traceback (most recent call last):\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727208829.292844-43895-253913134719839/AnsiballZ_cron.py\", line 107, in <module>\r\n    _ansiballz_main()\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727208829.292844-43895-253913134719839/AnsiballZ_cron.py\", line 99, in _ansiballz_main\r\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727208829.292844-43895-253913134719839/AnsiballZ_cron.py\", line 47, in invoke_module\r\n    runpy.run_module(mod_name='ansible.modules.cron', init_globals=dict(_module_fqn='ansible.modules.cron', _modlib_path=modlib_path),\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 225, in run_module\r\n    return _run_module_code(code, init_globals, run_name, mod_spec)\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 97, in _run_module_code\r\n    _run_code(code, mod_globals, init_globals,\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 87, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/tmp/ansible_ansible.builtin.cron_payload_5dlh3y3d/ansible_ansible.builtin.cron_payload.zip/ansible/modules/cron.py\", line 765, in <module>\r\n  File \"/tmp/ansible_ansible.builtin.cron_payload_5dlh3y3d/ansible_ansible.builtin.cron_payload.zip/ansible/modules/cron.py\", line 735, in main\r\n  File \"/tmp/ansible_ansible.builtin.cron_payload_5dlh3y3d/ansible_ansible.builtin.cron_payload.zip/ansible/modules/cron.py\", line 308, in write\r\nPermissionError: [Errno 13] Permission denied: b'/etc/cron.d/aide_cron'\r\n", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.3.3 | PATCH | Ensure cryptographic mechanisms are used to protect the integrity of audit tools] ***
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "Path /etc/aide.conf does not exist !", "rc": 257}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.4.1 | PATCH | Ensure bootloader password is set] ***********
[0;31mfatal: [node]: FAILED! => {"msg": "Failed to get information on remote file (/boot/grub2/user.cfg): Permission denied"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.4.2 | PATCH | Ensure permissions on bootloader config are configured] ***
[0;31mfailed: [node] (item={'path': 'grub.cfg', 'mode': '0700'}) => {"ansible_loop_var": "item", "changed": false, "item": {"mode": "0700", "path": "grub.cfg"}, "msg": "Error, could not touch target: [Errno 13] Permission denied: b'/boot/grub2/grub.cfg'", "path": "/boot/grub2/grub.cfg"}[0m
[0;31mfailed: [node] (item={'path': 'grubenv', 'mode': '0600'}) => {"ansible_loop_var": "item", "changed": false, "item": {"mode": "0600", "path": "grubenv"}, "msg": "Error, could not touch target: [Errno 13] Permission denied: b'/boot/grub2/grubenv'", "path": "/boot/grub2/grubenv"}[0m
[0;31mfailed: [node] (item={'path': 'user.cfg', 'mode': '0600'}) => {"ansible_loop_var": "item", "changed": false, "item": {"mode": "0600", "path": "user.cfg"}, "msg": "Error, could not touch target: [Errno 13] Permission denied: b'/boot/grub2/user.cfg'", "path": "/boot/grub2/user.cfg"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.5.1 | PATCH | Ensure core dump storage is disabled] ********
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 13] Permission denied: b'/home/ec2-user/.ansible/tmp/ansible-tmp-1727208839.923412-43980-135700750011677/tmpdetw8aks' -> b'/etc/systemd/coredump.conf'[0m
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "The destination directory (/etc/systemd) is not writable by the current user. Error was: [Errno 13] Permission denied: b'/etc/systemd/.ansible_tmpjl7k7067coredump.conf'"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.5.2 | PATCH | Ensure core dump backtraces are disabled] ****
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 13] Permission denied: b'/home/ec2-user/.ansible/tmp/ansible-tmp-1727208841.819951-43991-175261964040850/tmpbhnoyqqe' -> b'/etc/systemd/coredump.conf'[0m
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "The destination directory (/etc/systemd) is not writable by the current user. Error was: [Errno 13] Permission denied: b'/etc/systemd/.ansible_tmp2z7f67d4coredump.conf'"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.5.3 | PATCH | Ensure address space layout randomization (ASLR) is enabled] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 1.5.3 | PATCH | Ensure address space layout randomization (ASLR) is enabled] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": "Control being set via Handler 'update sysctl' which writes to /etc/sysctl.d/60-kernel_sysctl.conf"[0m
[0;32m}[0m

TASK [RHEL9-CIS : SECTION | 1.6 | Mandatory Access Control] ********************
[0;36mincluded: /Users/meesam/.ansible/roles/RHEL9-CIS/tasks/section_1/cis_1.6.1.x.yml for node[0m

TASK [RHEL9-CIS : 1.6.1.1 | PATCH | Ensure SELinux is installed] ***************
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "This command has to be run under the root user.", "results": []}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.6.1.2 | PATCH | Ensure SELinux is not disabled in bootloader configuration] ***
[0;32mok: [node] => (item=selinux=0)[0m
[0;32mok: [node] => (item=enforcing=0)[0m

TASK [RHEL9-CIS : 1.6.1.3 | PATCH | Ensure SELinux policy is configured] *******
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 13] Permission denied[0m
[0;31mfatal: [node]: FAILED! => {"changed": false, "module_stderr": "Shared connection to 13.233.97.162 closed.\r\n", "module_stdout": "Traceback (most recent call last):\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727208849.2722502-44040-52300371225757/AnsiballZ_selinux.py\", line 107, in <module>\r\n    _ansiballz_main()\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727208849.2722502-44040-52300371225757/AnsiballZ_selinux.py\", line 99, in _ansiballz_main\r\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727208849.2722502-44040-52300371225757/AnsiballZ_selinux.py\", line 47, in invoke_module\r\n    runpy.run_module(mod_name='ansible_collections.ansible.posix.plugins.modules.selinux', init_globals=dict(_module_fqn='ansible_collections.ansible.posix.plugins.modules.selinux', _modlib_path=modlib_path),\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 225, in run_module\r\n    return _run_module_code(code, init_globals, run_name, mod_spec)\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 97, in _run_module_code\r\n    _run_code(code, mod_globals, init_globals,\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 87, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/tmp/ansible_ansible.posix.selinux_payload_uc7bwz53/ansible_ansible.posix.selinux_payload.zip/ansible_collections/ansible/posix/plugins/modules/selinux.py\", line 347, in <module>\r\n  File \"/tmp/ansible_ansible.posix.selinux_payload_uc7bwz53/ansible_ansible.posix.selinux_payload.zip/ansible_collections/ansible/posix/plugins/modules/selinux.py\", line 312, in main\r\n  File \"/tmp/ansible_ansible.posix.selinux_payload_uc7bwz53/ansible_ansible.posix.selinux_payload.zip/ansible_collections/ansible/posix/plugins/modules/selinux.py\", line 182, in set_state\r\n  File \"/usr/lib64/python3.9/site-packages/selinux/__init__.py\", line 813, in security_setenforce\r\n    return _selinux.security_setenforce(value)\r\nPermissionError: [Errno 13] Permission denied\r\n", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.6.1.4 | PATCH | Ensure the SELinux state is not disabled] ***
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 13] Permission denied[0m
[0;31mfatal: [node]: FAILED! => {"changed": false, "module_stderr": "Shared connection to 13.233.97.162 closed.\r\n", "module_stdout": "Traceback (most recent call last):\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727208851.50913-44053-223857509126149/AnsiballZ_selinux.py\", line 107, in <module>\r\n    _ansiballz_main()\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727208851.50913-44053-223857509126149/AnsiballZ_selinux.py\", line 99, in _ansiballz_main\r\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727208851.50913-44053-223857509126149/AnsiballZ_selinux.py\", line 47, in invoke_module\r\n    runpy.run_module(mod_name='ansible_collections.ansible.posix.plugins.modules.selinux', init_globals=dict(_module_fqn='ansible_collections.ansible.posix.plugins.modules.selinux', _modlib_path=modlib_path),\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 225, in run_module\r\n    return _run_module_code(code, init_globals, run_name, mod_spec)\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 97, in _run_module_code\r\n    _run_code(code, mod_globals, init_globals,\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 87, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/tmp/ansible_ansible.posix.selinux_payload_a0znlmp7/ansible_ansible.posix.selinux_payload.zip/ansible_collections/ansible/posix/plugins/modules/selinux.py\", line 347, in <module>\r\n  File \"/tmp/ansible_ansible.posix.selinux_payload_a0znlmp7/ansible_ansible.posix.selinux_payload.zip/ansible_collections/ansible/posix/plugins/modules/selinux.py\", line 312, in main\r\n  File \"/tmp/ansible_ansible.posix.selinux_payload_a0znlmp7/ansible_ansible.posix.selinux_payload.zip/ansible_collections/ansible/posix/plugins/modules/selinux.py\", line 182, in set_state\r\n  File \"/usr/lib64/python3.9/site-packages/selinux/__init__.py\", line 813, in security_setenforce\r\n    return _selinux.security_setenforce(value)\r\nPermissionError: [Errno 13] Permission denied\r\n", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.6.1.5 | PATCH | Ensure the SELinux state is enforcing] *****
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 13] Permission denied[0m
[0;31mfatal: [node]: FAILED! => {"changed": false, "module_stderr": "Shared connection to 13.233.97.162 closed.\r\n", "module_stdout": "Traceback (most recent call last):\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727208853.676358-44066-126158437475333/AnsiballZ_selinux.py\", line 107, in <module>\r\n    _ansiballz_main()\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727208853.676358-44066-126158437475333/AnsiballZ_selinux.py\", line 99, in _ansiballz_main\r\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727208853.676358-44066-126158437475333/AnsiballZ_selinux.py\", line 47, in invoke_module\r\n    runpy.run_module(mod_name='ansible_collections.ansible.posix.plugins.modules.selinux', init_globals=dict(_module_fqn='ansible_collections.ansible.posix.plugins.modules.selinux', _modlib_path=modlib_path),\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 225, in run_module\r\n    return _run_module_code(code, init_globals, run_name, mod_spec)\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 97, in _run_module_code\r\n    _run_code(code, mod_globals, init_globals,\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 87, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/tmp/ansible_ansible.posix.selinux_payload__vgr44f2/ansible_ansible.posix.selinux_payload.zip/ansible_collections/ansible/posix/plugins/modules/selinux.py\", line 347, in <module>\r\n  File \"/tmp/ansible_ansible.posix.selinux_payload__vgr44f2/ansible_ansible.posix.selinux_payload.zip/ansible_collections/ansible/posix/plugins/modules/selinux.py\", line 312, in main\r\n  File \"/tmp/ansible_ansible.posix.selinux_payload__vgr44f2/ansible_ansible.posix.selinux_payload.zip/ansible_collections/ansible/posix/plugins/modules/selinux.py\", line 182, in set_state\r\n  File \"/usr/lib64/python3.9/site-packages/selinux/__init__.py\", line 813, in security_setenforce\r\n    return _selinux.security_setenforce(value)\r\nPermissionError: [Errno 13] Permission denied\r\n", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.6.1.6 | AUDIT | Ensure no unconfined services exist | Find the unconfined services] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 1.6.1.6 | AUDIT | Ensure no unconfined services exist | Message on unconfined services] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": "Warning!! You have unconfined services: ['amazon-ssm-agen']"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 1.6.1.6 | AUDIT | Set fact for manual task warning.] *********
[0;32mok: [node][0m

TASK [RHEL9-CIS : 1.6.1.7 | PATCH | Ensure SETroubleshoot is not installed] ****
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.6.1.8 | PATCH | Ensure the MCS Translation Service (mcstrans) is not installed] ***
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "This command has to be run under the root user.", "results": []}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.7.1 | PATCH | Ensure message of the day is configured properly] ***
[0;31mfatal: [node]: FAILED! => {"changed": false, "checksum": "cec9080ba0c26a7270c899d971650c7a18e11b8e", "msg": "Destination /etc not writable"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.7.2 | PATCH | Ensure local login warning banner is configured properly] ***
[0;31mfatal: [node]: FAILED! => {"changed": false, "checksum": "cec9080ba0c26a7270c899d971650c7a18e11b8e", "msg": "Destination /etc not writable"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.7.3 | PATCH | Ensure remote login warning banner is configured properly] ***
[0;31mfatal: [node]: FAILED! => {"changed": false, "checksum": "cec9080ba0c26a7270c899d971650c7a18e11b8e", "msg": "Destination /etc not writable"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 1.7.4 | PATCH | Ensure permissions on /etc/motd are configured] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 1.7.5 | PATCH | Ensure permissions on /etc/issue are configured] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 1.7.6 | PATCH | Ensure permissions on /etc/issue.net are configured] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 1.8.1 | PATCH | Ensure GNOME Display Manager is removed] *****
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.8.2 | PATCH | Ensure GDM login banner is configured | gdm profile] ***
[0;36mskipping: [node] => (item={'regexp': 'user-db', 'line': 'user-db:user'}) [0m
[0;36mskipping: [node] => (item={'regexp': 'system-db', 'line': 'system-db:gdm'}) [0m
[0;36mskipping: [node] => (item={'regexp': 'file-db', 'line': 'file-db:/usr/share/gdm/greeter-dconf-defaults'}) [0m
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.8.2 | PATCH | Ensure GDM login banner is configured | gdm profile] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.8.3 | PATCH | Ensure GDM disable-user-list option is enabled] ***
[0;36mskipping: [node] => (item={'file': '/etc/dconf/profile/gdm', 'regexp': 'user-db', 'line': 'user-db:user'}) [0m
[0;36mskipping: [node] => (item={'file': '/etc/dconf/profile/gdm', 'regexp': 'system-db', 'line': 'system-db:gdm'}) [0m
[0;36mskipping: [node] => (item={'file': '/etc/dconf/profile/gdm', 'regexp': 'file-db', 'line': 'file-db:/usr/share/gdm/greeter-dconf-defaults'}) [0m
[0;36mskipping: [node] => (item={'file': '/etc/dconf/db/gdm.d/00-login-screen', 'regexp': '\\[org\\/gnome\\/login-screen\\]', 'line': '[org/gnome/login-screen]'}) [0m
[0;36mskipping: [node] => (item={'file': '/etc/dconf/db/gdm.d/00-login-screen', 'regexp': 'disable-user-list=', 'line': 'disable-user-list=true'}) [0m
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.8.4 | PATCH | Ensure GDM screen locks when the user is idle | User profile] ***
[0;36mskipping: [node] => (item={'regexp': '^user-db', 'line': 'user-db:user'}) [0m
[0;36mskipping: [node] => (item={'regexp': '^system-db', 'line': 'system-db:local'}) [0m
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.8.4 | PATCH | Ensure GDM screen locks when the user is idle | Make db directory] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.8.4 | PATCH | Ensure GDM screen locks when the user is idle | Make conf file] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.8.5 | PATCH | Ensure GDM screen locks cannot be overridden | Make lock directory] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.8.5 | PATCH | Ensure GDM screen locks cannot be overridden | Make lock file] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.8.6 | PATCH | Ensure GDM automatic mounting of removable media is disabled] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.8.7 | PATCH | Ensure GDM disabling automatic mounting of removable media is not overridden | Make lock directory] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.8.7 | PATCH | Ensure GDM disabling automatic mounting of removable media is not overridden | Make lock file] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.8.8 | PATCH | Ensure GDM autorun-never is enabled | Make directory] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.8.8 | PATCH | Ensure GDM autorun-never is enabled | Make conf file] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.8.9 | PATCH | Ensure GDM autorun-never is not overridden | Make lock directory] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.8.9 | PATCH | Ensure GDM autorun-never is not overridden | Make lockfile] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.8.10 | PATCH | Ensure XDMCP is not enabled] ****************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.9 | PATCH | Ensure updates, patches, and additional security software are installed] ***
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "This command has to be run under the root user.", "results": []}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : SECTION | 1.10 | Crypto policies] ****************************
[0;36mincluded: /Users/meesam/.ansible/roles/RHEL9-CIS/tasks/section_1/cis_1.10.yml for node[0m

TASK [RHEL9-CIS : 1.10 | PATCH | Ensure system-wide crypto policy is not legacy | set_fact] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 1.10 | PATCH | Ensure system-wide crypto policy is not legacy] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.1.1 | PATCH | Ensure time synchronization is in use] *******
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "This command has to be run under the root user.", "results": []}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 2.1.2 | PATCH | Ensure chrony is configured | Set configuration] ***
[0;31mfatal: [node]: FAILED! => {"changed": false, "checksum": "9ad0a973c0d27a6a86197f5cd09621bb89593c42", "msg": "Destination /etc not writable"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 2.1.2 | PATCH | Ensure chrony is configured | modify /etc/sysconfig/chronyd | 1] ***
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 13] Permission denied: b'/home/ec2-user/.ansible/tmp/ansible-tmp-1727208884.110236-44271-252694623614486/tmp49f7rmnv' -> b'/etc/sysconfig/chronyd'[0m
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "The destination directory (/etc/sysconfig) is not writable by the current user. Error was: [Errno 13] Permission denied: b'/etc/sysconfig/.ansible_tmpwxfow4nnchronyd'"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 2.2.1 | PATCH | Ensure xorg-x11-server-common is not installed] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.2.2 | PATCH | Ensure Avahi Server is not installed] ********
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.2.3 | PATCH | Ensure CUPS is not installed] ****************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.2.4 | PATCH | Ensure DHCP Server is not installed] *********
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.2.5 | PATCH | Ensure DNS Server is not installed] **********
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.2.6 | PATCH | Ensure VSFTP Server is not installed] ********
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.2.7 | PACH | Ensure TFTP Server is not installed] **********
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.2.8 | PATCH | Ensure a web server is not installed | Remove httpd server] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.2.8 | PATCH | Ensure a web server is not installed | Remove nginx server] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.2.9 | PATCH | Ensure IMAP and POP3 server is not installed] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.2.9 | PATCH | Ensure IMAP and POP3 server is not installed] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.2.10 | PATCH | Ensure Samba is not enabled] ****************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.2.11 | PATCH | Ensure HTTP Proxy Server is not installed] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.2.12 | PATCH | Ensure net-snmp is not installed] ***********
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.2.13 | PATCH | Ensure telnet-server is not installed] ******
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.2.14 | PATCH | Ensure dnsmasq is not installed] ************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.2.15 | PATCH | Ensure mail transfer agent is configured for local-only mode] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.2.16 | PATCH | Ensure nfs-utils is not installed or the nfs-server service is masked | remove package] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.2.16 | PATCH | Ensure nfs-utils is not installed or the nfs-server service is masked | mask service] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.2.17 | PATCH | Ensure rpcbind is not installed or the rpcbind services are masked | remove package] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.2.17 | PATCH | Ensure rpcbind is not installed or the rpcbind services are masked | mask service] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.2.18 | PATCH | Ensure rsync-daemon is not installed or the rsync service is masked | remove package] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.2.18 | PATCH | Ensure rsync service is not enabled | mask service] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.3.1 | PATCH | Ensure telnet client is not installed] *******
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.3.2 | PATCH | Ensure LDAP client is not installed] *********
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.3.3 | PATCH | Ensure TFTP client is not installed] *********
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.3.4 | PATCH | Ensure FTP client is not installed] **********
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 2.4 | AUDIT | Ensure nonessential services listening on the system are removed or masked | Get list of services] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 2.4 | AUDIT | Ensure nonessential services listening on the system are removed or masked | Get list of sockets] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 2.4 | AUDIT | Ensure nonessential services listening on the system are removed or masked | Display list of services] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": [[0m
[0;32m        "Warning!! Below are the list of services and sockets, both active and inactive",[0m
[0;32m        "Please review to make sure all are essential",[0m
[0;32m        [[0m
[0;32m            "  UNIT                                                                                      LOAD   ACTIVE SUB     DESCRIPTION",[0m
[0;32m            "  amazon-ssm-agent.service                                                                  loaded active running amazon-ssm-agent",[0m
[0;32m            "  auditd.service                                                                            loaded active running Security Auditing Service",[0m
[0;32m            "  chronyd.service                                                                           loaded active running NTP client/server",[0m
[0;32m            "  crond.service                                                                             loaded active running Command Scheduler",[0m
[0;32m            "  dbus-broker.service                                                                       loaded active running D-Bus System Message Bus",[0m
[0;32m            "  dracut-shutdown.service                                                                   loaded active exited  Restore /run/initramfs on shutdown",[0m
[0;32m            "  firewalld.service                                                                         loaded active running firewalld - dynamic firewall daemon",[0m
[0;32m            "  getty@tty1.service                                                                        loaded active running Getty on tty1",[0m
[0;32m            "  import-state.service                                                                      loaded active exited  Import network configuration from initramfs",[0m
[0;32m            "  irqbalance.service                                                                        loaded active running irqbalance daemon",[0m
[0;32m            "  kdump.service                                                                             loaded active exited  Crash recovery kernel arming",[0m
[0;32m            "  kmod-static-nodes.service                                                                 loaded active exited  Create List of Static Device Nodes",[0m
[0;32m            "  lvm2-monitor.service                                                                      loaded active exited  Monitoring of LVM2 mirrors, snapshots etc. using dmeventd or progress polling",[0m
[0;32m            "  NetworkManager-wait-online.service                                                        loaded active exited  Network Manager Wait Online",[0m
[0;32m            "  NetworkManager.service                                                                    loaded active running Network Manager",[0m
[0;32m            "  nis-domainname.service                                                                    loaded active exited  Read and set NIS domainname from /etc/sysconfig/network",[0m
[0;32m            "  plymouth-quit-wait.service                                                                loaded active exited  Hold until boot process finishes up",[0m
[0;32m            "  plymouth-quit.service                                                                     loaded active exited  Terminate Plymouth Boot Screen",[0m
[0;32m            "  plymouth-read-write.service                                                               loaded active exited  Tell Plymouth To Write Out Runtime Data",[0m
[0;32m            "  polkit.service                                                                            loaded active running Authorization Manager",[0m
[0;32m            "  rsyslog.service                                                                           loaded active running System Logging Service",[0m
[0;32m            "  serial-getty@ttyS0.service                                                                loaded active running Serial Getty on ttyS0",[0m
[0;32m            "  sshd.service                                                                              loaded active running OpenSSH server daemon",[0m
[0;32m            "  systemd-fsck-root.service                                                                 loaded active exited  File System Check on Root Device",[0m
[0;32m            "  systemd-fsck@dev-disk-by\\x2duuid-f4b7b313\\x2d6b2f\\x2d4c6f\\x2d8e91\\x2d5c09b696cf60.service loaded active exited  File System Check on /dev/disk/by-uuid/f4b7b313-6b2f-4c6f-8e91-5c09b696cf60",[0m
[0;32m            "  systemd-journal-flush.service                                                             loaded active exited  Flush Journal to Persistent Storage",[0m
[0;32m            "  systemd-journald.service                                                                  loaded active running Journal Service",[0m
[0;32m            "  systemd-logind.service                                                                    loaded active running User Login Management",[0m
[0;32m            "  systemd-random-seed.service                                                               loaded active exited  Load/Save Random Seed",[0m
[0;32m            "  systemd-remount-fs.service                                                                loaded active exited  Remount Root and Kernel File Systems",[0m
[0;32m            "  systemd-sysctl.service                                                                    loaded active exited  Apply Kernel Variables",[0m
[0;32m            "  systemd-tmpfiles-setup-dev.service                                                        loaded active exited  Create Static Device Nodes in /dev",[0m
[0;32m            "  systemd-tmpfiles-setup.service                                                            loaded active exited  Create Volatile Files and Directories",[0m
[0;32m            "  systemd-udev-trigger.service                                                              loaded active exited  Coldplug All udev Devices",[0m
[0;32m            "  systemd-udevd.service                                                                     loaded active running Rule-based Manager for Device Events and Files",[0m
[0;32m            "  systemd-update-utmp.service                                                               loaded active exited  Record System Boot/Shutdown in UTMP",[0m
[0;32m            "  systemd-user-sessions.service                                                             loaded active exited  Permit User Sessions",[0m
[0;32m            "  systemd-vconsole-setup.service                                                            loaded active exited  Setup Virtual Console",[0m
[0;32m            "  tuned.service                                                                             loaded active running Dynamic System Tuning Daemon",[0m
[0;32m            "  user-runtime-dir@1000.service                                                             loaded active exited  User Runtime Directory /run/user/1000",[0m
[0;32m            "  user@1000.service                                                                         loaded active running User Manager for UID 1000",[0m
[0;32m            "",[0m
[0;32m            "LOAD   = Reflects whether the unit definition was properly loaded.",[0m
[0;32m            "ACTIVE = The high-level unit activation state, i.e. generalization of SUB.",[0m
[0;32m            "SUB    = The low-level unit activation state, values depend on unit type.",[0m
[0;32m            "41 loaded units listed. Pass --all to see loaded but inactive units, too.",[0m
[0;32m            "To show all installed unit files use 'systemctl list-unit-files'."[0m
[0;32m        ],[0m
[0;32m        [[0m
[0;32m            "  UNIT                            LOAD   ACTIVE SUB       DESCRIPTION",[0m
[0;32m            "  dbus.socket                     loaded active running   D-Bus System Message Bus Socket",[0m
[0;32m            "  dm-event.socket                 loaded active listening Device-mapper event daemon FIFOs",[0m
[0;32m            "  lvm2-lvmpolld.socket            loaded active listening LVM2 poll daemon socket",[0m
[0;32m            "  sssd-kcm.socket                 loaded active listening SSSD Kerberos Cache Manager responder socket",[0m
[0;32m            "  systemd-coredump.socket         loaded active listening Process Core Dump Socket",[0m
[0;32m            "  systemd-initctl.socket          loaded active listening initctl Compatibility Named Pipe",[0m
[0;32m            "  systemd-journald-dev-log.socket loaded active running   Journal Socket (/dev/log)",[0m
[0;32m            "  systemd-journald.socket         loaded active running   Journal Socket",[0m
[0;32m            "  systemd-rfkill.socket           loaded active listening Load/Save RF Kill Switch Status /dev/rfkill Watch",[0m
[0;32m            "  systemd-udevd-control.socket    loaded active running   udev Control Socket",[0m
[0;32m            "  systemd-udevd-kernel.socket     loaded active running   udev Kernel Socket",[0m
[0;32m            "",[0m
[0;32m            "LOAD   = Reflects whether the unit definition was properly loaded.",[0m
[0;32m            "ACTIVE = The high-level unit activation state, i.e. generalization of SUB.",[0m
[0;32m            "SUB    = The low-level unit activation state, values depend on unit type.",[0m
[0;32m            "11 loaded units listed. Pass --all to see loaded but inactive units, too.",[0m
[0;32m            "To show all installed unit files use 'systemctl list-unit-files'."[0m
[0;32m        ][0m
[0;32m    ][0m
[0;32m}[0m

TASK [RHEL9-CIS : 2.4 | AUDIT | Set fact for manual task warning.] *************
[0;32mok: [node][0m

TASK [RHEL9-CIS : 3.1.1 | PATCH | Ensure IPv6 status is identified | refresh] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.1.1 | PATCH | Ensure IPv6 status is identified | disable] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.1.2 | AUDIT | Ensure wireless interfaces are disabled | Check if nmcli command is available | if wlan exists] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.1.2 | AUDIT | Ensure wireless interfaces are disabled | Check if wifi is enabled] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.1.2 | PATCH | Ensure wireless interfaces are disabled | Disable wifi if enabled] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.1.3 | PATCH | Ensure TIPC is disabled] *********************
[0;31mfailed: [node] (item=tipc) => {"ansible_loop_var": "item", "changed": false, "checksum": "11a5b7d516bdc04085079da387ebe10b7678c90b", "item": "tipc", "msg": "Destination /etc/modprobe.d not writable"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 3.1.3 | PATCH | Ensure TIPC is disabled | blacklist] *********
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 13] Permission denied: b'/home/ec2-user/.ansible/tmp/ansible-tmp-1727208893.4595242-44362-116568769417152/tmp9t5jvb67' -> b'/etc/modprobe.d/blacklist.conf'[0m
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "The destination directory (/etc/modprobe.d) is not writable by the current user. Error was: [Errno 13] Permission denied: b'/etc/modprobe.d/.ansible_tmpx8hnxo9iblacklist.conf'"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 3.2.1 | PATCH | Ensure IP forwarding is disabled | Disable IPv4 forwarding | Set Fact] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 3.2.1 | PATCH | Ensure IP forwarding is disabled | Disable IPv4 forwarding] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": "Control being set via Handler 'update sysctl' which writes to /etc/sysctl.d/60-netipv4_sysctl.conf"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 3.2.1 | PATCH | Ensure IP forwarding is disabled | Disable IPv6 forwarding | Set Fact] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 3.2.1 | PATCH | Ensure IP forwarding is disabled | Disable IPv6 forwarding] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": "Control being set via Handler 'update sysctl' which writes to /etc/sysctl.d/60-netipv6_sysctl.conf"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 3.2.2 | PATCH | Ensure packet redirect sending is disabled | Set Fact] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 3.2.2 | PATCH | Ensure packet redirect sending is disabled] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": "Control being set via Handler 'update sysctl' which writes to /etc/sysctl.d/60-netipv4_sysctl.conf"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 3.3.1 | PATCH | Ensure source routed packets are not accepted | IPv4 | Set Fact] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 3.3.1 | PATCH | Ensure source routed packets are not accepted | IPv4] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": "Control being set via Handler 'update sysctl' which writes to /etc/sysctl.d/60-netipv4_sysctl.conf"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 3.3.1 | PATCH | Ensure source routed packets are not accepted | IPv6 | Set Fact] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 3.3.1 | PATCH | Ensure source routed packets are not accepted | IPv6] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": "Control being set via Handler 'update sysctl' which writes to /etc/sysctl.d/60-netipv6_sysctl.conf"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 3.3.2 | PATCH | Ensure ICMP redirects are not accepted | IPv4 | Set Fact] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 3.3.2 | PATCH | Ensure ICMP redirects are not accepted | IPv4] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": "Control being set via Handler 'update sysctl' which writes to /etc/sysctl.d/60-netipv4_sysctl.conf"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 3.3.2 | PATCH | Ensure ICMP redirects are not accepted | IPv6 | Set Fact] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 3.3.2 | PATCH | Ensure ICMP redirects are not accepted | IPv6] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": "Control being set via Handler 'update sysctl' which writes to /etc/sysctl.d/60-netipv6_sysctl.conf"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 3.3.3 | PATCH | Ensure secure ICMP redirects are not accepted | Set Fact] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 3.3.3 | PATCH | Ensure secure ICMP redirects are not accepted] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": "Control being set via Handler 'update sysctl' which writes to /etc/sysctl.d/60-netipv4_sysctl.conf"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 3.3.4 | PATCH | Ensure suspicious packets are logged | Set Fact] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 3.3.4 | PATCH | Ensure suspicious packets are logged] ********
[0;32mok: [node] => {[0m
[0;32m    "msg": "Control being set via Handler 'update sysctl' which writes to /etc/sysctl.d/60-netipv4_sysctl.conf"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 3.3.5 | PATCH | Ensure broadcast ICMP requests are ignored | Set Fact] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 3.3.5 | PATCH | Ensure broadcast ICMP requests are ignored"] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": "Control being set via Handler 'update sysctl' which writes to /etc/sysctl.d/60-netipv4_sysctl.conf"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 3.3.6 | PATCH | Ensure bogus ICMP responses are ignored | Set Fact] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 3.3.6 | PATCH | Ensure bogus ICMP responses are ignored] *****
[0;32mok: [node] => {[0m
[0;32m    "msg": "Control being set via Handler 'update sysctl' which writes to /etc/sysctl.d/60-netipv4_sysctl.conf"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 3.3.7 | PATCH | Ensure Reverse Path Filtering is enabled | Set Fact] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 3.3.7 | PATCH | Ensure Reverse Path Filtering is enabled] ****
[0;32mok: [node] => {[0m
[0;32m    "msg": "Control being set via Handler 'update sysctl' which writes to /etc/sysctl.d/60-netipv4_sysctl.conf"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 3.3.8 | PATCH | Ensure TCP SYN Cookies is enabled | Set Fact] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 3.3.8 | PATCH | Ensure TCP SYN Cookies is enabled] ***********
[0;32mok: [node] => {[0m
[0;32m    "msg": "Control being set via Handler 'update sysctl' which writes to /etc/sysctl.d/60-netipv4_sysctl.conf"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 3.3.9 | PATCH | Ensure IPv6 router advertisements are not accepted | IPv6 | Set Fact] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 3.3.9 | PATCH | Ensure IPv6 router advertisements are not accepted | IPv6] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": "Control being set via Handler 'update sysctl' which writes to /etc/sysctl.d/60-netipv6_sysctl"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 3.4.1.1 | PATCH | Ensure nftables is installed] **************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.1.2 | PATCH | Ensure a single firewall configuration utility is in use | nftables] ***
[0;36mskipping: [node] => (item=firewalld) [0m
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.1.2 | PATCH | Ensure a single firewall configuration utility is in use | firewalld] ***
[0;31mfailed: [node] (item=nftables) => {"ansible_loop_var": "item", "changed": false, "item": "nftables", "module_stderr": "Shared connection to 13.233.97.162 closed.\r\n", "module_stdout": "\u001b[1;31m==== AUTHENTICATING FOR org.freedesktop.systemd1.manage-unit-files ====\r\n\u001b[0mAuthentication is required to manage system service or unit files.\r\nAuthenticating as: root\r\nPassword: \r\n{\"name\": \"nftables\", \"changed\": true, \"status\": {\"Type\": \"oneshot\", \"ExitType\": \"main\", \"Restart\": \"no\", \"NotifyAccess\": \"none\", \"RestartUSec\": \"100ms\", \"TimeoutStartUSec\": \"infinity\", \"TimeoutStopUSec\": \"1min 30s\", \"TimeoutAbortUSec\": \"1min 30s\", \"TimeoutStartFailureMode\": \"terminate\", \"TimeoutStopFailureMode\": \"terminate\", \"RuntimeMaxUSec\": \"infinity\", \"RuntimeRandomizedExtraUSec\": \"0\", \"WatchdogUSec\": \"infinity\", \"WatchdogTimestampMonotonic\": \"0\", \"RootDirectoryStartOnly\": \"no\", \"RemainAfterExit\": \"yes\", \"GuessMainPID\": \"yes\", \"MainPID\": \"0\", \"ControlPID\": \"0\", \"FileDescriptorStoreMax\": \"0\", \"NFileDescriptorStore\": \"0\", \"StatusErrno\": \"0\", \"Result\": \"success\", \"ReloadResult\": \"success\", \"CleanResult\": \"success\", \"UID\": \"[not set]\", \"GID\": \"[not set]\", \"NRestarts\": \"0\", \"OOMPolicy\": \"stop\", \"ExecMainStartTimestampMonotonic\": \"0\", \"ExecMainExitTimestampMonotonic\": \"0\", \"ExecMainPID\": \"0\", \"ExecMainCode\": \"0\", \"ExecMainStatus\": \"0\", \"ExecStart\": \"{ path=/sbin/nft ; argv[]=/sbin/nft -f /etc/sysconfig/nftables.conf ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }\", \"ExecStartEx\": \"{ path=/sbin/nft ; argv[]=/sbin/nft -f /etc/sysconfig/nftables.conf ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }\", \"ExecReload\": \"{ path=/sbin/nft ; argv[]=/sbin/nft flush ruleset; include \\\"/etc/sysconfig/nftables.conf\\\"; ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }\", \"ExecReloadEx\": \"{ path=/sbin/nft ; argv[]=/sbin/nft flush ruleset; include \\\"/etc/sysconfig/nftables.conf\\\"; ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }\", \"ExecStop\": \"{ path=/sbin/nft ; argv[]=/sbin/nft flush ruleset ; ignore_errors=no ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }\", \"ExecStopEx\": \"{ path=/sbin/nft ; argv[]=/sbin/nft flush ruleset ; flags= ; start_time=[n/a] ; stop_time=[n/a] ; pid=0 ; code=(null) ; status=0/0 }\", \"Slice\": \"system.slice\", \"ControlGroupId\": \"0\", \"MemoryCurrent\": \"[not set]\", \"MemoryAvailable\": \"infinity\", \"CPUUsageNSec\": \"[not set]\", \"TasksCurrent\": \"[not set]\", \"IPIngressBytes\": \"[no data]\", \"IPIngressPackets\": \"[no data]\", \"IPEgressBytes\": \"[no data]\", \"IPEgressPackets\": \"[no data]\", \"IOReadBytes\": \"18446744073709551615\", \"IOReadOperations\": \"18446744073709551615\", \"IOWriteBytes\": \"18446744073709551615\", \"IOWriteOperations\": \"18446744073709551615\", \"Delegate\": \"no\", \"CPUAccounting\": \"yes\", \"CPUWeight\": \"[not set]\", \"StartupCPUWeight\": \"[not set]\", \"CPUShares\": \"[not set]\", \"StartupCPUShares\": \"[not set]\", \"CPUQuotaPerSecUSec\": \"infinity\", \"CPUQuotaPeriodUSec\": \"infinity\", \"IOAccounting\": \"no\", \"IOWeight\": \"[not set]\", \"StartupIOWeight\": \"[not set]\", \"BlockIOAccounting\": \"no\", \"BlockIOWeight\": \"[not set]\", \"StartupBlockIOWeight\": \"[not set]\", \"MemoryAccounting\": \"yes\", \"DefaultMemoryLow\": \"0\", \"DefaultMemoryMin\": \"0\", \"MemoryMin\": \"0\", \"MemoryLow\": \"0\", \"MemoryHigh\": \"infinity\", \"MemoryMax\": \"infinity\", \"MemorySwapMax\": \"infinity\", \"MemoryLimit\": \"infinity\", \"DevicePolicy\": \"auto\", \"TasksAccounting\": \"yes\", \"TasksMax\": \"21395\", \"IPAccounting\": \"no\", \"ManagedOOMSwap\": \"auto\", \"ManagedOOMMemoryPressure\": \"auto\", \"ManagedOOMMemoryPressureLimit\": \"0\", \"ManagedOOMPreference\": \"none\", \"UMask\": \"0022\", \"LimitCPU\": \"infinity\", \"LimitCPUSoft\": \"infinity\", \"LimitFSIZE\": \"infinity\", \"LimitFSIZESoft\": \"infinity\", \"LimitDATA\": \"infinity\", \"LimitDATASoft\": \"infinity\", \"LimitSTACK\": \"infinity\", \"LimitSTACKSoft\": \"8388608\", \"LimitCORE\": \"infinity\", \"LimitCORESoft\": \"0\", \"LimitRSS\": \"infinity\", \"LimitRSSSoft\": \"infinity\", \"LimitNOFILE\": \"524288\", \"LimitNOFILESoft\": \"1024\", \"LimitAS\": \"infinity\", \"LimitASSoft\": \"infinity\", \"LimitNPROC\": \"13372\", \"LimitNPROCSoft\": \"13372\", \"LimitMEMLOCK\": \"8388608\", \"LimitMEMLOCKSoft\": \"8388608\", \"LimitLOCKS\": \"infinity\", \"LimitLOCKSSoft\": \"infinity\", \"LimitSIGPENDING\": \"13372\", \"LimitSIGPENDINGSoft\": \"13372\", \"LimitMSGQUEUE\": \"819200\", \"LimitMSGQUEUESoft\": \"819200\", \"LimitNICE\": \"0\", \"LimitNICESoft\": \"0\", \"LimitRTPRIO\": \"0\", \"LimitRTPRIOSoft\": \"0\", \"LimitRTTIME\": \"infinity\", \"LimitRTTIMESoft\": \"infinity\", \"OOMScoreAdjust\": \"0\", \"CoredumpFilter\": \"0x33\", \"Nice\": \"0\", \"IOSchedulingClass\": \"2\", \"IOSchedulingPriority\": \"4\", \"CPUSchedulingPolicy\": \"0\", \"CPUSchedulingPriority\": \"0\", \"CPUAffinityFromNUMA\": \"no\", \"NUMAPolicy\": \"n/a\", \"TimerSlackNSec\": \"50000\", \"CPUSchedulingResetOnFork\": \"no\", \"NonBlocking\": \"no\", \"StandardInput\": \"null\", \"StandardOutput\": \"journal\", \"StandardError\": \"inherit\", \"TTYReset\": \"no\", \"TTYVHangup\": \"no\", \"TTYVTDisallocate\": \"no\", \"SyslogPriority\": \"30\", \"SyslogLevelPrefix\": \"yes\", \"SyslogLevel\": \"6\", \"SyslogFacility\": \"3\", \"LogLevelMax\": \"-1\", \"LogRateLimitIntervalUSec\": \"0\", \"LogRateLimitBurst\": \"0\", \"SecureBits\": \"0\", \"CapabilityBoundingSet\": \"cap_chown cap_dac_override cap_dac_read_search cap_fowner cap_fsetid cap_kill cap_setgid cap_setuid cap_setpcap cap_linux_immutable cap_net_bind_service cap_net_broadcast cap_net_admin cap_net_raw cap_ipc_lock cap_ipc_owner cap_sys_module cap_sys_rawio cap_sys_chroot cap_sys_ptrace cap_sys_pacct cap_sys_admin cap_sys_boot cap_sys_nice cap_sys_resource cap_sys_time cap_sys_tty_config cap_mknod cap_lease cap_audit_write cap_audit_control cap_setfcap cap_mac_override cap_mac_admin cap_syslog cap_wake_alarm cap_block_suspend cap_audit_read cap_perfmon cap_bpf cap_checkpoint_restore\", \"DynamicUser\": \"no\", \"RemoveIPC\": \"no\", \"PrivateTmp\": \"no\", \"PrivateDevices\": \"no\", \"ProtectClock\": \"no\", \"ProtectKernelTunables\": \"no\", \"ProtectKernelModules\": \"no\", \"ProtectKernelLogs\": \"no\", \"ProtectControlGroups\": \"no\", \"PrivateNetwork\": \"no\", \"PrivateUsers\": \"no\", \"PrivateMounts\": \"no\", \"PrivateIPC\": \"no\", \"ProtectHome\": \"yes\", \"ProtectSystem\": \"full\", \"SameProcessGroup\": \"no\", \"UtmpMode\": \"init\", \"IgnoreSIGPIPE\": \"yes\", \"NoNewPrivileges\": \"no\", \"SystemCallErrorNumber\": \"2147483646\", \"LockPersonality\": \"no\", \"RuntimeDirectoryPreserve\": \"no\", \"RuntimeDirectoryMode\": \"0755\", \"StateDirectoryMode\": \"0755\", \"CacheDirectoryMode\": \"0755\", \"LogsDirectoryMode\": \"0755\", \"ConfigurationDirectoryMode\": \"0755\", \"TimeoutCleanUSec\": \"infinity\", \"MemoryDenyWriteExecute\": \"no\", \"RestrictRealtime\": \"no\", \"RestrictSUIDSGID\": \"no\", \"RestrictNamespaces\": \"no\", \"MountAPIVFS\": \"no\", \"KeyringMode\": \"private\", \"ProtectProc\": \"default\", \"ProcSubset\": \"all\", \"ProtectHostname\": \"no\", \"KillMode\": \"control-group\", \"KillSignal\": \"15\", \"RestartKillSignal\": \"15\", \"FinalKillSignal\": \"9\", \"SendSIGKILL\": \"yes\", \"SendSIGHUP\": \"no\", \"WatchdogSignal\": \"6\", \"Id\": \"nftables.service\", \"Names\": \"nftables.service\", \"Requires\": \"system.slice sysinit.target\", \"Wants\": \"network-pre.target\", \"Conflicts\": \"shutdown.target\", \"ConflictedBy\": \"firewalld.service\", \"Before\": \"network-pre.target shutdown.target\", \"After\": \"sysinit.target basic.target system.slice systemd-journald.socket\", \"Documentation\": \"\\\"man:nft(8)\\\"\", \"Description\": \"Netfilter Tables\", \"AccessSELinuxContext\": \"system_u:object_r:systemd_unit_file_t:s0\", \"LoadState\": \"loaded\", \"ActiveState\": \"inactive\", \"FreezerState\": \"running\", \"SubState\": \"dead\", \"FragmentPath\": \"/usr/lib/systemd/system/nftables.service\", \"UnitFileState\": \"disabled\", \"UnitFilePreset\": \"disabled\", \"StateChangeTimestampMonotonic\": \"0\", \"InactiveExitTimestampMonotonic\": \"0\", \"ActiveEnterTimestampMonotonic\": \"0\", \"ActiveExitTimestampMonotonic\": \"0\", \"InactiveEnterTimestampMonotonic\": \"0\", \"CanStart\": \"yes\", \"CanStop\": \"yes\", \"CanReload\": \"yes\", \"CanIsolate\": \"no\", \"CanFreeze\": \"yes\", \"StopWhenUnneeded\": \"no\", \"RefuseManualStart\": \"no\", \"RefuseManualStop\": \"no\", \"AllowIsolate\": \"no\", \"DefaultDependencies\": \"yes\", \"OnSuccessJobMode\": \"fail\", \"OnFailureJobMode\": \"replace\", \"IgnoreOnIsolate\": \"no\", \"NeedDaemonReload\": \"no\", \"JobTimeoutUSec\": \"infinity\", \"JobRunningTimeoutUSec\": \"infinity\", \"JobTimeoutAction\": \"none\", \"ConditionResult\": \"no\", \"AssertResult\": \"no\", \"ConditionTimestampMonotonic\": \"0\", \"AssertTimestampMonotonic\": \"0\", \"Transient\": \"no\", \"Perpetual\": \"no\", \"StartLimitIntervalUSec\": \"10s\", \"StartLimitBurst\": \"5\", \"StartLimitAction\": \"none\", \"FailureAction\": \"none\", \"SuccessAction\": \"none\", \"CollectMode\": \"inactive\"}, \"invocation\": {\"module_args\": {\"name\": \"nftables\", \"masked\": true, \"daemon_reload\": false, \"daemon_reexec\": false, \"scope\": \"system\", \"no_block\": false, \"state\": null, \"enabled\": null, \"force\": null}}}polkit-agent-helper-1: pam_authenticate failed: Authentication failure\r\n\r\n", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 0}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 3.4.1.2 | PATCH | Ensure a single firewall configuration utility is in use | package installed] ***
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "This command has to be run under the root user.", "results": []}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 3.4.1.2 | PATCH | Ensure a single firewall configuration utility is in use | firewalld started and enabled] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 3.4.2.1 | AUDIT | Ensure firewalld default zone is set] ******
[0;32mok: [node][0m

TASK [RHEL9-CIS : 3.4.2.1 | AUDIT | Ensure firewalld default zone is set] ******
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.2 | AUDIT | Ensure a table exists | Check for tables] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.2 | AUDIT | Ensure an nftables table exists | Show existing tables] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.2 | AUDIT | Ensure an nftables table exists | Alert on no tables] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.2 | AUDIT | Set fact for manual task warning.] *********
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.2 | PATCH | Ensure a table exists | Create table if needed] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.3 | AUDIT | Ensure nftables base chains exist | Get current chains for INPUT] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.3 | AUDIT | Ensure nftables base chains exist | Get current chains for FORWARD] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.3 | AUDIT | Ensure nftables base chains exist | Get current chains for OUTPUT] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.3 | AUDIT | Ensure nftables base chains exist | Display chains for review] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.3 | PATCH | Ensure nftables base chains exist | Create chains if needed] ***
[0;36mskipping: [node] => (item=nft create chain inet "filter" input { type filter hook input priority 0 \; }) [0m
[0;36mskipping: [node] => (item=nft create chain inet "filter" forward { type filter hook forward priority 0 \; }) [0m
[0;36mskipping: [node] => (item=nft create chain inet "filter" output { type filter hook output priority 0 \; }) [0m
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.4 | AUDIT | Ensure host based firewall loopback traffic is configured | Gather iif lo accept existence | nftables] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.4 | AUDIT | Ensure host based firewall loopback traffic is configured | Gather ip saddr existence | nftables] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.4 | AUDIT | Ensure host based firewall loopback traffic is configured | Gather ip6 saddr existence | nftables] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.4 | PATCH | Ensure host based firewall loopback traffic is configured | Set iif lo accept rule | nftables] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.4 | PATCH | Ensure host based firewall loopback traffic is configured | Set ip sddr rule | nftables] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.4 | PATCH | Ensure host based firewall loopback traffic is configured | Set ip6 saddr rule | nftables] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.4 | PATCH | Ensure host based firewall loopback traffic is configured | firewalld] ***
[0;31mfailed: [node] (item=rule family="ipv4" source address="127.0.0.1" destination not address="127.0.0.1" drop) => {"ansible_loop_var": "item", "changed": false, "item": "rule family=\"ipv4\" source address=\"127.0.0.1\" destination not address=\"127.0.0.1\" drop", "msg": "ERROR: Exception caught: org.fedoraproject.FirewallD1.NotAuthorizedException: Not Authorized(polkit): org.fedoraproject.FirewallD1.config"}[0m
[0;31mfailed: [node] (item=rule family="ipv6" source address="::1" destination not address="::1" drop) => {"ansible_loop_var": "item", "changed": false, "item": "rule family=\"ipv6\" source address=\"::1\" destination not address=\"::1\" drop", "msg": "ERROR: Exception caught: org.fedoraproject.FirewallD1.NotAuthorizedException: Not Authorized(polkit): org.fedoraproject.FirewallD1.config"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 3.4.2.5 | AUDIT | Ensure firewalld drops unnecessary services and ports | Get list of services and ports] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 3.4.2.5 | AUDIT | Ensure firewalld drops unnecessary services and ports | Show services and ports] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": [[0m
[0;32m        "The items below are the services and ports that are accepted, please correct as needed",[0m
[0;32m        [][0m
[0;32m    ][0m
[0;32m}[0m

TASK [RHEL9-CIS : 3.4.2.6 | AUDIT | Ensure nftables established connections are configured | Gather incoming connection rules] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.6| AUDIT | Ensure nftables established connections are configured | Gather outbound connection rules] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.6| PATCH | Ensure nftables established connections are configured | Add input tcp established accept policy] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.6 | PATCH | Ensure nftables established connections are configured | Add input udp established accept policy] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.6 | PATCH | Ensure nftables established connections are configured | Add input icmp established accept policy] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.6 | PATCH | Ensure nftables established connections are configured | Add output tcp new, related, established accept policy] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.6 | PATCH | Ensure nftables established connections are configured | Add output udp new, related, established accept policy] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.6 | PATCH | Ensure nftables established connections are configured | Add output icmp new, related, established accept policy] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.7 | AUDIT | Ensure nftables default deny firewall policy | Check for hook input deny policy] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.7 | AUDIT | Ensure nftables default deny firewall policy | Check for hook forward deny policy] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.7 | AUDIT | Ensure nftables default deny firewall policy | Check for hook output deny policy] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.7 | AUDIT | Ensure nftables default deny firewall policy | Check for SSH allow] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.7 | PATCH | Ensure nftables default deny firewall policy | Enable SSH traffic] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.7 | PATCH | Ensure nftables default deny firewall policy | Set hook input deny policy] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.7 | PATCH | Ensure nftables default deny firewall policy | Create hook forward deny policy] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 3.4.2.7 | PATCH | Ensure nftables default deny firewall policy | Create hook output deny policy] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 4.1.1.1 | PATCH | Ensure auditd is installed | Install auditd packages] ***
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "This command has to be run under the root user.", "results": []}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 4.1.1.1 | PATCH | Ensure auditd is installed | Install auditd-lib packages] ***
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "This command has to be run under the root user.", "results": []}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 4.1.1.2 | PATCH | Ensure auditing for processes that start prior to auditd is enabled | Grubby existence of current value] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.1.2 | PATCH | Ensure auditing for processes that start prior to auditd is enabled | Grubby update, if needed] ***
[0;33mchanged: [node][0m

TASK [RHEL9-CIS : 4.1.1.3 | AUDIT | Ensure audit_backlog_limit is sufficient | Grubby existence of current value] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.1.3 | AUDIT | Check to see if limits are set] ************
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.1.3 | AUDIT | Check to see if any limits are too low] ****
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 4.1.1.3 | AUDIT | Ensure audit_backlog_limit is sufficient | Grubby update applied] ***
[0;33mchanged: [node][0m

TASK [RHEL9-CIS : 4.1.1.4 | PATCH | Ensure auditd service is enabled] **********
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.2.1 | PATCH | Ensure audit log storage size is configured] ***
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "Destination /etc/audit/auditd.conf does not exist !", "rc": 257}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 4.1.2.2 | PATCH | Ensure audit logs are not automatically deleted] ***
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "Destination /etc/audit/auditd.conf does not exist !", "rc": 257}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 4.1.2.3 | PATCH | Ensure system is disabled when audit logs are full] ***
[0;31mfailed: [node] (item={'regexp': '^admin_space_left_action', 'line': 'admin_space_left_action = halt'}) => {"ansible_loop_var": "item", "changed": false, "item": {"line": "admin_space_left_action = halt", "regexp": "^admin_space_left_action"}, "msg": "Destination /etc/audit/auditd.conf does not exist !", "rc": 257}[0m
[0;31mfailed: [node] (item={'regexp': '^action_mail_acct', 'line': 'action_mail_acct = root'}) => {"ansible_loop_var": "item", "changed": false, "item": {"line": "action_mail_acct = root", "regexp": "^action_mail_acct"}, "msg": "Destination /etc/audit/auditd.conf does not exist !", "rc": 257}[0m
[0;31mfailed: [node] (item={'regexp': '^space_left_action', 'line': 'space_left_action = email'}) => {"ansible_loop_var": "item", "changed": false, "item": {"line": "space_left_action = email", "regexp": "^space_left_action"}, "msg": "Destination /etc/audit/auditd.conf does not exist !", "rc": 257}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : PATCH | Configure other keys for auditd.conf] ****************
[0;36mskipping: [node] => (item=admin_space_left) [0m
[0;36mskipping: [node] => (item=space_left) [0m
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 4.1.3.1 | PATCH | Ensure changes to system administration scope (sudoers) is collected] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.3.2 | PATCH | Ensure actions as another user are always logged] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.3.3 | PATCH | Ensure events that modify the sudo log file are collected] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.3.4 | PATCH | Ensure events that modify date and time information are collected] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.3.5 | PATCH | Ensure events that modify the system's network environment are collected] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.3.6 | PATCH | Ensure use of privileged commands is collected] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.3.6 | PATCH | Ensure use of privileged commands is collected] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.3.7 | PATCH | Ensure unsuccessful unauthorized file access attempts are collected] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.3.8 | PATCH | Ensure events that modify user/group information are collected] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.3.9 | PATCH | Ensure discretionary access control permission modification events are collected] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.3.10 | PATCH | Ensure successful file system mounts are collected] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.3.11 | PATCH | Ensure session initiation information is collected] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.3.12 | PATCH | Ensure login and logout events are collected] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.3.13 | PATCH | Ensure file deletion events by users are collected] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.3.14 | PATCH | Ensure events that modify the system's Mandatory Access Controls are collected] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.3.15 | PATCH | Ensure successful and unsuccessful attempts to use the chcon command are recorded] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.3.16 | PATCH | Ensure successful and unsuccessful attempts to use the setfacl command are recorded] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.3.17 | PATCH | Ensure successful and unsuccessful attempts to use the chacl command are recorded] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.3.18 | PATCH | Ensure successful and unsuccessful attempts to use the usermod command are recorded] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.3.19 | PATCH | Ensure kernel module loading and unloading is collected] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.3.20 | PATCH | Ensure the audit configuration is immutable] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.3.21 | AUDIT | Ensure the running and on disk configuration is the same] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": [[0m
[0;32m        "Please run augenrules --load if you suspect there is a configuration that is not active"[0m
[0;32m    ][0m
[0;32m}[0m

TASK [RHEL9-CIS : Auditd | 4.1.3 | Auditd controls updated] ********************
[0;32mok: [node] => {[0m
[0;32m    "msg": "Auditd Controls handled in POST using template - updating /etc/auditd/rules.d/99_auditd.rules"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 4.1.4.1 | AUDIT | Ensure audit log files are mode 0640 or less permissive | discover file] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.4.1 | AUDIT | Ensure audit log files are mode 0640 or less permissive | stat file] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : "4.1.4.1 | PATCH | Ensure audit log files are mode 0640 or less permissive"
"4.1.4.2 | PATCH | Ensure only authorized users own audit log files"
"4.1.4.3 | PATCH | Ensure only authorized groups are assigned ownership of audit log files"] ***
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "file () is absent, cannot continue", "path": "", "state": "absent"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 4.1.4.4 | AUDIT | Ensure the audit log directory is 0750 or more restrictive | get current permissions] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.1.4.4 | PATCH | Ensure the audit log directory is 0750 or more restrictive | set] ***
[0;31mfatal: [node]: FAILED! => {"msg": "The conditional check 'not auditlog_dir.stat.mode is match('07(0|5)0')' failed. The error was: error while evaluating conditional (not auditlog_dir.stat.mode is match('07(0|5)0')): 'dict object' has no attribute 'mode'\n\nThe error appears to be in '/Users/meesam/.ansible/roles/RHEL9-CIS/tasks/section_4/cis_4.1.4.x.yml': line 49, column 9, but may\nbe elsewhere in the file depending on the exact syntax problem.\n\nThe offending line appears to be:\n\n\n      - name: \"4.1.4.4 | PATCH | Ensure the audit log directory is 0750 or more restrictive | set\"\n        ^ here\n"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 4.1.4.5 | PATCH | Ensure audit configuration files are 640 or more restrictive] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 4.1.4.6 | PATCH | Ensure audit configuration files are owned by root] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 4.1.4.7 | PATCH | Ensure audit configuration files belong to group root] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 4.1.4.8 | AUDIT | Get audit binary file stat | get current mode] ***
[0;32mok: [node] => (item=/sbin/auditctl)[0m
[0;32mok: [node] => (item=/sbin/aureport)[0m
[0;32mok: [node] => (item=/sbin/ausearch)[0m
[0;32mok: [node] => (item=/sbin/autrace)[0m
[0;32mok: [node] => (item=/sbin/auditd)[0m
[0;32mok: [node] => (item=/sbin/augenrules)[0m

TASK [RHEL9-CIS : 4.1.4.8 | PATCH | Ensure audit tools are 755 or more restrictive | set if required] ***
[0;32mok: [node] => (item=/sbin/auditctl)[0m
[0;32mok: [node] => (item=/sbin/aureport)[0m
[0;32mok: [node] => (item=/sbin/ausearch)[0m
[0;36mskipping: [node] => (item=/sbin/autrace) [0m
[0;32mok: [node] => (item=/sbin/auditd)[0m
[0;32mok: [node] => (item=/sbin/augenrules)[0m

TASK [RHEL9-CIS : 4.1.4.9 | PATCH | Ensure audit tools are owned by root] ******
[0;32mok: [node] => (item=/sbin/auditctl)[0m
[0;32mok: [node] => (item=/sbin/aureport)[0m
[0;32mok: [node] => (item=/sbin/ausearch)[0m
[0;32mok: [node] => (item=/sbin/autrace)[0m
[0;32mok: [node] => (item=/sbin/auditd)[0m
[0;32mok: [node] => (item=/sbin/augenrules)[0m

TASK [RHEL9-CIS : 4.1.4.10 | PATCH | Ensure audit tools belong to group root] ***
[0;32mok: [node] => (item=/sbin/auditctl)[0m
[0;32mok: [node] => (item=/sbin/aureport)[0m
[0;32mok: [node] => (item=/sbin/ausearch)[0m
[0;32mok: [node] => (item=/sbin/autrace)[0m
[0;32mok: [node] => (item=/sbin/auditd)[0m
[0;32mok: [node] => (item=/sbin/augenrules)[0m

TASK [RHEL9-CIS : 4.2.1.1 | PATCH | Ensure rsyslog installed] ******************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 4.2.1.2 | PATCH | Ensure rsyslog Service is enabled] *********
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.2.1.3 | PATCH | Ensure journald is configured to send logs to rsyslog] ***
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 13] Permission denied: b'/home/ec2-user/.ansible/tmp/ansible-tmp-1727209084.833802-45220-107994844162416/tmpxrdmpcya' -> b'/etc/systemd/journald.conf'[0m
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "The destination directory (/etc/systemd) is not writable by the current user. Error was: [Errno 13] Permission denied: b'/etc/systemd/.ansible_tmpkoex2ue4journald.conf'"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 4.2.1.4 | PATCH | Ensure rsyslog default file permissions configured] ***
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 13] Permission denied: b'/home/ec2-user/.ansible/tmp/ansible-tmp-1727209086.628693-45234-137317647827041/tmpqcyp52al' -> b'/etc/rsyslog.conf'[0m
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "The destination directory (/etc) is not writable by the current user. Error was: [Errno 13] Permission denied: b'/etc/.ansible_tmpwpu7mdafrsyslog.conf'"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 4.2.1.5 | AUDIT | Ensure logging is configured | rsyslog current config message out] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.2.1.5 | AUDIT | Ensure logging is configured | rsyslog current config message out] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": [[0m
[0;32m        "These are the current logging configurations for rsyslog, please review:",[0m
[0;32m        [[0m
[0;32m            "global(workDirectory=\"/var/lib/rsyslog\")",[0m
[0;32m            "module(load=\"builtin:omfile\" Template=\"RSYSLOG_TraditionalFileFormat\")",[0m
[0;32m            "include(file=\"/etc/rsyslog.d/*.conf\" mode=\"optional\")",[0m
[0;32m            "module(load=\"imuxsock\" \t  # provides support for local system logging (e.g. via logger command)",[0m
[0;32m            "       SysSock.Use=\"off\") # Turn off message reception via local log socket; ",[0m
[0;32m            "\t\t\t  # local messages are retrieved through imjournal now.",[0m
[0;32m            "module(load=\"imjournal\" \t    # provides access to the systemd journal",[0m
[0;32m            "       StateFile=\"imjournal.state\") # File to store the position in the journal",[0m
[0;32m            "*.info;mail.none;authpriv.none;cron.none                /var/log/messages",[0m
[0;32m            "authpriv.*                                              /var/log/secure",[0m
[0;32m            "mail.*                                                  -/var/log/maillog",[0m
[0;32m            "cron.*                                                  /var/log/cron",[0m
[0;32m            "*.emerg                                                 :omusrmsg:*",[0m
[0;32m            "uucp,news.crit                                          /var/log/spooler",[0m
[0;32m            "local7.*                                                /var/log/boot.log"[0m
[0;32m        ][0m
[0;32m    ][0m
[0;32m}[0m

TASK [RHEL9-CIS : 4.2.1.5 | PATCH | Ensure logging is configured | mail.* log setting] ***
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 13] Permission denied: b'/home/ec2-user/.ansible/tmp/ansible-tmp-1727209090.245355-45254-74113936530365/tmpzpoxqtu7' -> b'/etc/rsyslog.conf'[0m
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "The destination directory (/etc) is not writable by the current user. Error was: [Errno 13] Permission denied: b'/etc/.ansible_tmpipi5wux0rsyslog.conf'"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 4.2.1.5 | PATCH | Ensure logging is configured | news.crit log setting] ***
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 13] Permission denied: b'/home/ec2-user/.ansible/tmp/ansible-tmp-1727209092.105716-45265-18519691080512/tmp9jltu1qx' -> b'/etc/rsyslog.conf'[0m
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "The destination directory (/etc) is not writable by the current user. Error was: [Errno 13] Permission denied: b'/etc/.ansible_tmpi4xomqnnrsyslog.conf'"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 4.2.1.5 | PATCH | Ensure logging is configured | Misc. log setting] ***
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 13] Permission denied: b'/home/ec2-user/.ansible/tmp/ansible-tmp-1727209094.196248-45280-136030436212645/tmp038j8tgt' -> b'/etc/rsyslog.conf'[0m
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "The destination directory (/etc) is not writable by the current user. Error was: [Errno 13] Permission denied: b'/etc/.ansible_tmpukhaqn8hrsyslog.conf'"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 4.2.1.5 | PATCH | Ensure logging is configured | Local log settings] ***
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 13] Permission denied: b'/home/ec2-user/.ansible/tmp/ansible-tmp-1727209096.239421-45295-226418288096808/tmpu2gocb_g' -> b'/etc/rsyslog.conf'[0m
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "The destination directory (/etc) is not writable by the current user. Error was: [Errno 13] Permission denied: b'/etc/.ansible_tmppfuq3_dersyslog.conf'"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 4.2.1.5 | PATCH | Ensure logging is configured | Auth Settings] ***
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 13] Permission denied: b'/home/ec2-user/.ansible/tmp/ansible-tmp-1727209097.9609191-45308-195845398229111/tmpc60d_o41' -> b'/etc/rsyslog.conf'[0m
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "The destination directory (/etc) is not writable by the current user. Error was: [Errno 13] Permission denied: b'/etc/.ansible_tmp3q41ggf1rsyslog.conf'"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 4.2.1.5 | PATCH | Ensure logging is configured | Cron Settings] ***
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 13] Permission denied: b'/home/ec2-user/.ansible/tmp/ansible-tmp-1727209099.763425-45320-252410755401317/tmpr4jd3t3d' -> b'/etc/rsyslog.conf'[0m
[0;31mfatal: [node]: FAILED! => {"changed": false, "msg": "The destination directory (/etc) is not writable by the current user. Error was: [Errno 13] Permission denied: b'/etc/.ansible_tmpg6sfeo0srsyslog.conf'"}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : 4.2.1.6 | PATCH | Ensure rsyslog is configured to send logs to a remote log host] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 4.2.1.7 | PATCH | Ensure rsyslog is not configured to recieve logs from a remote client. | When not log host] ***
[0;32mok: [node] => (item=^(\$ModLoad imtcp))[0m
[0;32mok: [node] => (item=^(\$InputTCPServerRun))[0m
[0;32mok: [node] => (item=^(module\(load="imtcp"\)))[0m
[0;32mok: [node] => (item=^(input\(type="imtcp"))[0m

TASK [RHEL9-CIS : 4.2.1.7 | PATCH | Ensure rsyslog is not configured to recieve logs from a remote clients. | When log host] ***
[0;36mskipping: [node] => (item=ModLoad imtcp) [0m
[0;36mskipping: [node] => (item=InputTCPServerRun) [0m
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 4.2.2.1.1 | PATCH | Ensure systemd-journal-remote is installed] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 4.2.2.1.2 | PATCH | Ensure systemd-journal-remote is configured] ***
[0;36mskipping: [node] => (item={'regexp': 'URL=', 'line': 'URL=192.168.50.42'}) [0m
[0;36mskipping: [node] => (item={'regexp': 'ServerKeyFile=', 'line': 'ServerKeyFile=/etc/ssl/private/journal-upload.pem'}) [0m
[0;36mskipping: [node] => (item={'regexp': 'ServerCertificateFile=', 'line': 'ServerCertificateFile=/etc/ssl/certs/journal-upload.pem'}) [0m
[0;36mskipping: [node] => (item={'regexp': 'TrustedCertificateFile=', 'line': 'TrustedCertificateFile=/etc/ssl/ca/trusted.pem'}) [0m
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 4.2.2.1.3 | PATCH | Ensure systemd-journal-remote is enabled] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 4.2.2.1.4 | PATCH | Ensure journald is not configured to recieve logs from a remote client] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 4.2.2.2 | PATCH | Ensure journald service is enabled | Enable service] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 4.2.2.2 | AUDIT | Ensure journald service is enabled | Capture status] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 4.2.2.2 | AUDIT | Ensure journald service is enabled | Alert on bad status] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 4.2.2.2 | AUDIT | Set fact for manual task warning.] *********
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 4.2.2.3 | PATCH | Ensure journald is configured to compress large log files] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 4.2.2.4 | PATCH | Ensure journald is configured to write logfiles to persistent disk] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 4.2.2.5 | PATCH | Ensure journald is not configured to send logs to rsyslog] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 4.2.2.6 | PATCH | Ensure journald log rotation is configured per site policy] ***
[0;36mskipping: [node] => (item={'regexp': '^#SystemMaxUse=|^SystemMaxUse=', 'line': 'SystemMaxUse=10M'}) [0m
[0;36mskipping: [node] => (item={'regexp': '^#SystemKeepFree=|^SystemKeepFree=', 'line': 'SystemKeepFree=100G'}) [0m
[0;36mskipping: [node] => (item={'regexp': '^#RuntimeMaxUse=|^RuntimeMaxUse=', 'line': 'RuntimeMaxUse=10M'}) [0m
[0;36mskipping: [node] => (item={'regexp': '^#RuntimeKeepFree=|^RuntimeKeepFree=', 'line': 'RuntimeKeepFree=100G'}) [0m
[0;36mskipping: [node] => (item={'regexp': '^#MaxFileSec=|^MaxFileSec=', 'line': 'MaxFileSec=1month'}) [0m
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 4.2.2.7 | AUDIT | Ensure journald default file permissions configured | Check for override file] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 4.2.2.7 | AUDIT | Ensure journald default file permissions configured | Set live file] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 4.2.2.7 | PATCH | Ensure journald default file permissions configured | Set permission] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 4.2.3 | AUDIT | Ensure permissions on all logfiles are configured | find files] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 4.2.3 | PATCH | Ensure permissions on all logfiles are configured | change permissions] ***
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 1] Operation not permitted: b'/var/log/hawkey.log'[0m
[0;31mfailed: [node] (item=/var/log/hawkey.log) => {"ansible_loop_var": "item", "changed": false, "failed_when_result": "The conditional check 'rhel9cis_4_2_3_file_list.state not in '[ file, absent ]'' failed. The error was: error while evaluating conditional (rhel9cis_4_2_3_file_list.state not in '[ file, absent ]'): Unable to look up a name or access an attribute in template string ({% if rhel9cis_4_2_3_file_list.state not in '[ file, absent ]' %} True {% else %} False {% endif %}).\nMake sure your variable name does not contain invalid characters like '-': 'in <string>' requires string as left operand, not AnsibleUndefined. 'in <string>' requires string as left operand, not AnsibleUndefined", "item": {"atime": 1727208434.4928584, "ctime": 1727208434.4928584, "dev": 64512, "gid": 0, "gr_name": "root", "inode": 393409, "isblk": false, "ischr": false, "isdir": false, "isfifo": false, "isgid": false, "islnk": false, "isreg": true, "issock": false, "isuid": false, "mode": "0644", "mtime": 1727208434.4928584, "nlink": 1, "path": "/var/log/hawkey.log", "pw_name": "root", "rgrp": true, "roth": true, "rusr": true, "size": 60, "uid": 0, "wgrp": false, "woth": false, "wusr": true, "xgrp": false, "xoth": false, "xusr": false}, "module_stderr": "Shared connection to 13.233.97.162 closed.\r\n", "module_stdout": "Traceback (most recent call last):\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727209112.6835132-45421-81191794368586/AnsiballZ_file.py\", line 107, in <module>\r\n    _ansiballz_main()\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727209112.6835132-45421-81191794368586/AnsiballZ_file.py\", line 99, in _ansiballz_main\r\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727209112.6835132-45421-81191794368586/AnsiballZ_file.py\", line 47, in invoke_module\r\n    runpy.run_module(mod_name='ansible.modules.file', init_globals=dict(_module_fqn='ansible.modules.file', _modlib_path=modlib_path),\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 225, in run_module\r\n    return _run_module_code(code, init_globals, run_name, mod_spec)\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 97, in _run_module_code\r\n    _run_code(code, mod_globals, init_globals,\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 87, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_jh8zgbx1/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 988, in <module>\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_jh8zgbx1/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 972, in main\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_jh8zgbx1/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 613, in ensure_file_attributes\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_jh8zgbx1/ansible_ansible.builtin.file_payload.zip/ansible/module_utils/basic.py\", line 1100, in set_fs_attributes_if_different\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_jh8zgbx1/ansible_ansible.builtin.file_payload.zip/ansible/module_utils/basic.py\", line 860, in set_mode_if_different\r\nPermissionError: [Errno 1] Operation not permitted: b'/var/log/hawkey.log'\r\n", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}[0m
[0;36mskipping: [node] => (item=/var/log/btmp) [0m
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 1] Operation not permitted: b'/var/log/lastlog'[0m
[0;31mfailed: [node] (item=/var/log/lastlog) => {"ansible_loop_var": "item", "changed": false, "failed_when_result": "The conditional check 'rhel9cis_4_2_3_file_list.state not in '[ file, absent ]'' failed. The error was: error while evaluating conditional (rhel9cis_4_2_3_file_list.state not in '[ file, absent ]'): Unable to look up a name or access an attribute in template string ({% if rhel9cis_4_2_3_file_list.state not in '[ file, absent ]' %} True {% else %} False {% endif %}).\nMake sure your variable name does not contain invalid characters like '-': 'in <string>' requires string as left operand, not AnsibleUndefined. 'in <string>' requires string as left operand, not AnsibleUndefined", "item": {"atime": 1727209111.9168959, "ctime": 1727209111.9168959, "dev": 64512, "gid": 22, "gr_name": "utmp", "inode": 393336, "isblk": false, "ischr": false, "isdir": false, "isfifo": false, "isgid": false, "islnk": false, "isreg": true, "issock": false, "isuid": false, "mode": "0664", "mtime": 1727209111.9168959, "nlink": 1, "path": "/var/log/lastlog", "pw_name": "root", "rgrp": true, "roth": true, "rusr": true, "size": 292584, "uid": 0, "wgrp": true, "woth": false, "wusr": true, "xgrp": false, "xoth": false, "xusr": false}, "module_stderr": "Shared connection to 13.233.97.162 closed.\r\n", "module_stdout": "Traceback (most recent call last):\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727209114.917033-45421-192548295978354/AnsiballZ_file.py\", line 107, in <module>\r\n    _ansiballz_main()\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727209114.917033-45421-192548295978354/AnsiballZ_file.py\", line 99, in _ansiballz_main\r\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727209114.917033-45421-192548295978354/AnsiballZ_file.py\", line 47, in invoke_module\r\n    runpy.run_module(mod_name='ansible.modules.file', init_globals=dict(_module_fqn='ansible.modules.file', _modlib_path=modlib_path),\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 225, in run_module\r\n    return _run_module_code(code, init_globals, run_name, mod_spec)\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 97, in _run_module_code\r\n    _run_code(code, mod_globals, init_globals,\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 87, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_3utrtj4x/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 988, in <module>\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_3utrtj4x/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 972, in main\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_3utrtj4x/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 613, in ensure_file_attributes\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_3utrtj4x/ansible_ansible.builtin.file_payload.zip/ansible/module_utils/basic.py\", line 1100, in set_fs_attributes_if_different\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_3utrtj4x/ansible_ansible.builtin.file_payload.zip/ansible/module_utils/basic.py\", line 860, in set_mode_if_different\r\nPermissionError: [Errno 1] Operation not permitted: b'/var/log/lastlog'\r\n", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}[0m
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 1] Operation not permitted: b'/var/log/secure'[0m
[0;31mfailed: [node] (item=/var/log/secure) => {"ansible_loop_var": "item", "changed": false, "failed_when_result": "The conditional check 'rhel9cis_4_2_3_file_list.state not in '[ file, absent ]'' failed. The error was: error while evaluating conditional (rhel9cis_4_2_3_file_list.state not in '[ file, absent ]'): Unable to look up a name or access an attribute in template string ({% if rhel9cis_4_2_3_file_list.state not in '[ file, absent ]' %} True {% else %} False {% endif %}).\nMake sure your variable name does not contain invalid characters like '-': 'in <string>' requires string as left operand, not AnsibleUndefined. 'in <string>' requires string as left operand, not AnsibleUndefined", "item": {"atime": 1687554802.7916293, "ctime": 1727208923.6743298, "dev": 64512, "gid": 0, "gr_name": "root", "inode": 393253, "isblk": false, "ischr": false, "isdir": false, "isfifo": false, "isgid": false, "islnk": false, "isreg": true, "issock": false, "isuid": false, "mode": "0644", "mtime": 1727208923.6743298, "nlink": 1, "path": "/var/log/secure", "pw_name": "root", "rgrp": true, "roth": true, "rusr": true, "size": 8349, "uid": 0, "wgrp": false, "woth": false, "wusr": true, "xgrp": false, "xoth": false, "xusr": false}, "module_stderr": "Shared connection to 13.233.97.162 closed.\r\n", "module_stdout": "Traceback (most recent call last):\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727209117.016447-45421-58666821322617/AnsiballZ_file.py\", line 107, in <module>\r\n    _ansiballz_main()\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727209117.016447-45421-58666821322617/AnsiballZ_file.py\", line 99, in _ansiballz_main\r\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727209117.016447-45421-58666821322617/AnsiballZ_file.py\", line 47, in invoke_module\r\n    runpy.run_module(mod_name='ansible.modules.file', init_globals=dict(_module_fqn='ansible.modules.file', _modlib_path=modlib_path),\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 225, in run_module\r\n    return _run_module_code(code, init_globals, run_name, mod_spec)\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 97, in _run_module_code\r\n    _run_code(code, mod_globals, init_globals,\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 87, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_pyp22rim/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 988, in <module>\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_pyp22rim/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 972, in main\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_pyp22rim/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 613, in ensure_file_attributes\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_pyp22rim/ansible_ansible.builtin.file_payload.zip/ansible/module_utils/basic.py\", line 1100, in set_fs_attributes_if_different\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_pyp22rim/ansible_ansible.builtin.file_payload.zip/ansible/module_utils/basic.py\", line 860, in set_mode_if_different\r\nPermissionError: [Errno 1] Operation not permitted: b'/var/log/secure'\r\n", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}[0m
[0;32mok: [node] => (item=/var/log/firewalld)[0m
[0;32mok: [node] => (item=/var/log/kdump.log)[0m
[0;36mskipping: [node] => (item=/var/log/wtmp) [0m
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 1] Operation not permitted: b'/var/log/dnf.log'[0m
[0;31mfailed: [node] (item=/var/log/dnf.log) => {"ansible_loop_var": "item", "changed": false, "failed_when_result": "The conditional check 'rhel9cis_4_2_3_file_list.state not in '[ file, absent ]'' failed. The error was: error while evaluating conditional (rhel9cis_4_2_3_file_list.state not in '[ file, absent ]'): Unable to look up a name or access an attribute in template string ({% if rhel9cis_4_2_3_file_list.state not in '[ file, absent ]' %} True {% else %} False {% endif %}).\nMake sure your variable name does not contain invalid characters like '-': 'in <string>' requires string as left operand, not AnsibleUndefined. 'in <string>' requires string as left operand, not AnsibleUndefined", "item": {"atime": 1727208431.8308504, "ctime": 1727208476.8269846, "dev": 64512, "gid": 0, "gr_name": "root", "inode": 393364, "isblk": false, "ischr": false, "isdir": false, "isfifo": false, "isgid": false, "islnk": false, "isreg": true, "issock": false, "isuid": false, "mode": "0644", "mtime": 1727208476.8269846, "nlink": 1, "path": "/var/log/dnf.log", "pw_name": "root", "rgrp": true, "roth": true, "rusr": true, "size": 1560, "uid": 0, "wgrp": false, "woth": false, "wusr": true, "xgrp": false, "xoth": false, "xusr": false}, "module_stderr": "Shared connection to 13.233.97.162 closed.\r\n", "module_stdout": "Traceback (most recent call last):\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727209123.452095-45421-224784852108700/AnsiballZ_file.py\", line 107, in <module>\r\n    _ansiballz_main()\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727209123.452095-45421-224784852108700/AnsiballZ_file.py\", line 99, in _ansiballz_main\r\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727209123.452095-45421-224784852108700/AnsiballZ_file.py\", line 47, in invoke_module\r\n    runpy.run_module(mod_name='ansible.modules.file', init_globals=dict(_module_fqn='ansible.modules.file', _modlib_path=modlib_path),\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 225, in run_module\r\n    return _run_module_code(code, init_globals, run_name, mod_spec)\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 97, in _run_module_code\r\n    _run_code(code, mod_globals, init_globals,\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 87, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_mkcasrac/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 988, in <module>\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_mkcasrac/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 972, in main\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_mkcasrac/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 613, in ensure_file_attributes\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_mkcasrac/ansible_ansible.builtin.file_payload.zip/ansible/module_utils/basic.py\", line 1100, in set_fs_attributes_if_different\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_mkcasrac/ansible_ansible.builtin.file_payload.zip/ansible/module_utils/basic.py\", line 860, in set_mode_if_different\r\nPermissionError: [Errno 1] Operation not permitted: b'/var/log/dnf.log'\r\n", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}[0m
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 1] Operation not permitted: b'/var/log/dnf.rpm.log'[0m
[0;31mfailed: [node] (item=/var/log/dnf.rpm.log) => {"ansible_loop_var": "item", "changed": false, "failed_when_result": "The conditional check 'rhel9cis_4_2_3_file_list.state not in '[ file, absent ]'' failed. The error was: error while evaluating conditional (rhel9cis_4_2_3_file_list.state not in '[ file, absent ]'): Unable to look up a name or access an attribute in template string ({% if rhel9cis_4_2_3_file_list.state not in '[ file, absent ]' %} True {% else %} False {% endif %}).\nMake sure your variable name does not contain invalid characters like '-': 'in <string>' requires string as left operand, not AnsibleUndefined. 'in <string>' requires string as left operand, not AnsibleUndefined", "item": {"atime": 1727208431.8318505, "ctime": 1727208431.8318505, "dev": 64512, "gid": 0, "gr_name": "root", "inode": 393372, "isblk": false, "ischr": false, "isdir": false, "isfifo": false, "isgid": false, "islnk": false, "isreg": true, "issock": false, "isuid": false, "mode": "0644", "mtime": 1727208431.8318505, "nlink": 1, "path": "/var/log/dnf.rpm.log", "pw_name": "root", "rgrp": true, "roth": true, "rusr": true, "size": 0, "uid": 0, "wgrp": false, "woth": false, "wusr": true, "xgrp": false, "xoth": false, "xusr": false}, "module_stderr": "Shared connection to 13.233.97.162 closed.\r\n", "module_stdout": "Traceback (most recent call last):\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727209125.334949-45421-257325814681902/AnsiballZ_file.py\", line 107, in <module>\r\n    _ansiballz_main()\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727209125.334949-45421-257325814681902/AnsiballZ_file.py\", line 99, in _ansiballz_main\r\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727209125.334949-45421-257325814681902/AnsiballZ_file.py\", line 47, in invoke_module\r\n    runpy.run_module(mod_name='ansible.modules.file', init_globals=dict(_module_fqn='ansible.modules.file', _modlib_path=modlib_path),\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 225, in run_module\r\n    return _run_module_code(code, init_globals, run_name, mod_spec)\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 97, in _run_module_code\r\n    _run_code(code, mod_globals, init_globals,\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 87, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_8zr31suc/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 988, in <module>\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_8zr31suc/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 972, in main\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_8zr31suc/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 613, in ensure_file_attributes\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_8zr31suc/ansible_ansible.builtin.file_payload.zip/ansible/module_utils/basic.py\", line 1100, in set_fs_attributes_if_different\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_8zr31suc/ansible_ansible.builtin.file_payload.zip/ansible/module_utils/basic.py\", line 860, in set_mode_if_different\r\nPermissionError: [Errno 1] Operation not permitted: b'/var/log/dnf.rpm.log'\r\n", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}[0m
[0;32mok: [node] => (item=/var/log/messages)[0m
[0;32mok: [node] => (item=/var/log/tallylog)[0m
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 1] Operation not permitted: b'/var/log/dnf.librepo.log'[0m
[0;31mfailed: [node] (item=/var/log/dnf.librepo.log) => {"ansible_loop_var": "item", "changed": false, "failed_when_result": "The conditional check 'rhel9cis_4_2_3_file_list.state not in '[ file, absent ]'' failed. The error was: error while evaluating conditional (rhel9cis_4_2_3_file_list.state not in '[ file, absent ]'): Unable to look up a name or access an attribute in template string ({% if rhel9cis_4_2_3_file_list.state not in '[ file, absent ]' %} True {% else %} False {% endif %}).\nMake sure your variable name does not contain invalid characters like '-': 'in <string>' requires string as left operand, not AnsibleUndefined. 'in <string>' requires string as left operand, not AnsibleUndefined", "item": {"atime": 1727208431.8318505, "ctime": 1727208460.3539355, "dev": 64512, "gid": 0, "gr_name": "root", "inode": 393370, "isblk": false, "ischr": false, "isdir": false, "isfifo": false, "isgid": false, "islnk": false, "isreg": true, "issock": false, "isuid": false, "mode": "0644", "mtime": 1727208460.3539355, "nlink": 1, "path": "/var/log/dnf.librepo.log", "pw_name": "root", "rgrp": true, "roth": true, "rusr": true, "size": 3308, "uid": 0, "wgrp": false, "woth": false, "wusr": true, "xgrp": false, "xoth": false, "xusr": false}, "module_stderr": "Shared connection to 13.233.97.162 closed.\r\n", "module_stdout": "Traceback (most recent call last):\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727209130.642199-45421-180097979439022/AnsiballZ_file.py\", line 107, in <module>\r\n    _ansiballz_main()\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727209130.642199-45421-180097979439022/AnsiballZ_file.py\", line 99, in _ansiballz_main\r\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727209130.642199-45421-180097979439022/AnsiballZ_file.py\", line 47, in invoke_module\r\n    runpy.run_module(mod_name='ansible.modules.file', init_globals=dict(_module_fqn='ansible.modules.file', _modlib_path=modlib_path),\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 225, in run_module\r\n    return _run_module_code(code, init_globals, run_name, mod_spec)\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 97, in _run_module_code\r\n    _run_code(code, mod_globals, init_globals,\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 87, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_9m_fn9oq/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 988, in <module>\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_9m_fn9oq/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 972, in main\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_9m_fn9oq/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 613, in ensure_file_attributes\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_9m_fn9oq/ansible_ansible.builtin.file_payload.zip/ansible/module_utils/basic.py\", line 1100, in set_fs_attributes_if_different\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_9m_fn9oq/ansible_ansible.builtin.file_payload.zip/ansible/module_utils/basic.py\", line 860, in set_mode_if_different\r\nPermissionError: [Errno 1] Operation not permitted: b'/var/log/dnf.librepo.log'\r\n", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}[0m
[0;32mok: [node] => (item=/var/log/cron)[0m
[0;32mok: [node] => (item=/var/log/journal/9b8e90b8d27d431c89f877b3ed235cd4/user-1000.journal)[0m
[0;32mok: [node] => (item=/var/log/journal/9b8e90b8d27d431c89f877b3ed235cd4/system.journal)[0m
[0;32mok: [node] => (item=/var/log/journal/9b8e90b8d27d431c89f877b3ed235cd4/user-1001.journal)[0m
[0;32mok: [node] => (item=/var/log/journal/9b8e90b8d27d431c89f877b3ed235cd4/system@729dcd7f465a4974bead67d5259b0298-0000000000000001-0005fd14c2e94129.journal)[0m
[0;32mok: [node] => (item=/var/log/journal/9b8e90b8d27d431c89f877b3ed235cd4/user-1000@6f12340ea3e44ed585ad279f2fc689a6-000000000000087e-0005fd14ee0b35d3.journal)[0m
[0;32mok: [node] => (item=/var/log/anaconda/X.log)[0m
[0;32mok: [node] => (item=/var/log/anaconda/hawkey.log)[0m
[0;32mok: [node] => (item=/var/log/anaconda/dbus.log)[0m
[0;32mok: [node] => (item=/var/log/anaconda/ks-script-llc094mc.log)[0m
[0;32mok: [node] => (item=/var/log/anaconda/storage.log)[0m
[0;32mok: [node] => (item=/var/log/anaconda/anaconda.log)[0m
[0;32mok: [node] => (item=/var/log/anaconda/ks-script-bd_m0sv1.log)[0m
[0;32mok: [node] => (item=/var/log/anaconda/program.log)[0m
[0;32mok: [node] => (item=/var/log/anaconda/lvm.log)[0m
[0;32mok: [node] => (item=/var/log/anaconda/syslog)[0m
[0;32mok: [node] => (item=/var/log/anaconda/journal.log)[0m
[0;32mok: [node] => (item=/var/log/anaconda/ks-script-nlp3miae.log)[0m
[0;32mok: [node] => (item=/var/log/anaconda/dnf.librepo.log)[0m
[0;32mok: [node] => (item=/var/log/anaconda/packaging.log)[0m
[0;31mAn exception occurred during task execution. To see the full traceback, use -vvv. The error was: PermissionError: [Errno 1] Operation not permitted: b'/var/log/tuned/tuned.log'[0m
[0;31mfailed: [node] (item=/var/log/tuned/tuned.log) => {"ansible_loop_var": "item", "changed": false, "failed_when_result": "The conditional check 'rhel9cis_4_2_3_file_list.state not in '[ file, absent ]'' failed. The error was: error while evaluating conditional (rhel9cis_4_2_3_file_list.state not in '[ file, absent ]'): Unable to look up a name or access an attribute in template string ({% if rhel9cis_4_2_3_file_list.state not in '[ file, absent ]' %} True {% else %} False {% endif %}).\nMake sure your variable name does not contain invalid characters like '-': 'in <string>' requires string as left operand, not AnsibleUndefined. 'in <string>' requires string as left operand, not AnsibleUndefined", "item": {"atime": 1643563274.757821, "ctime": 1727207675.400035, "dev": 64512, "gid": 0, "gr_name": "root", "inode": 398168, "isblk": false, "ischr": false, "isdir": false, "isfifo": false, "isgid": false, "islnk": false, "isreg": true, "issock": false, "isuid": false, "mode": "0644", "mtime": 1727207675.400035, "nlink": 1, "path": "/var/log/tuned/tuned.log", "pw_name": "root", "rgrp": true, "roth": true, "rusr": true, "size": 31264, "uid": 0, "wgrp": false, "woth": false, "wusr": true, "xgrp": false, "xoth": false, "xusr": false}, "module_stderr": "Shared connection to 13.233.97.162 closed.\r\n", "module_stdout": "Traceback (most recent call last):\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727209168.413482-45421-107906115987751/AnsiballZ_file.py\", line 107, in <module>\r\n    _ansiballz_main()\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727209168.413482-45421-107906115987751/AnsiballZ_file.py\", line 99, in _ansiballz_main\r\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\r\n  File \"/home/ec2-user/.ansible/tmp/ansible-tmp-1727209168.413482-45421-107906115987751/AnsiballZ_file.py\", line 47, in invoke_module\r\n    runpy.run_module(mod_name='ansible.modules.file', init_globals=dict(_module_fqn='ansible.modules.file', _modlib_path=modlib_path),\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 225, in run_module\r\n    return _run_module_code(code, init_globals, run_name, mod_spec)\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 97, in _run_module_code\r\n    _run_code(code, mod_globals, init_globals,\r\n  File \"/usr/lib64/python3.9/runpy.py\", line 87, in _run_code\r\n    exec(code, run_globals)\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_8n4f4hjz/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 988, in <module>\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_8n4f4hjz/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 972, in main\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_8n4f4hjz/ansible_ansible.builtin.file_payload.zip/ansible/modules/file.py\", line 613, in ensure_file_attributes\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_8n4f4hjz/ansible_ansible.builtin.file_payload.zip/ansible/module_utils/basic.py\", line 1100, in set_fs_attributes_if_different\r\n  File \"/tmp/ansible_ansible.builtin.file_payload_8n4f4hjz/ansible_ansible.builtin.file_payload.zip/ansible/module_utils/basic.py\", line 860, in set_mode_if_different\r\nPermissionError: [Errno 1] Operation not permitted: b'/var/log/tuned/tuned.log'\r\n", "msg": "MODULE FAILURE\nSee stdout/stderr for the exact error", "rc": 1}[0m
to see the full traceback, use -vvv

PLAY [all] *********************************************************************

TASK [Gathering Facts] *********************************************************
[0;32mok: [node][0m

TASK [RHEL9-CIS : Check OS version and family] *********************************
[0;32mok: [node] => {[0m
[0;32m    "changed": false,[0m
[0;32m    "msg": "This role is running against a supported OS OracleLinux 9"[0m
[0;32m}[0m

TASK [RHEL9-CIS : Check ansible version] ***************************************
[0;32mok: [node] => {[0m
[0;32m    "changed": false,[0m
[0;32m    "msg": "This role is running a supported version of ansible 2.17.3 >= 2.10.1"[0m
[0;32m}[0m

TASK [RHEL9-CIS : Check password set for ec2-user | password state] ************
[0;32mok: [node][0m

TASK [RHEL9-CIS : Check for local account ec2-user | Check for local account] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Check password set for ec2-user | Assert local password set] ***
[0;32mok: [node] => {[0m
[0;32m    "changed": false,[0m
[0;32m    "msg": "You have a password set for the ec2-user user"[0m
[0;32m}[0m

TASK [RHEL9-CIS : Check account is not locked for ec2-user | Assert local account not locked] ***
[0;31mfatal: [node]: FAILED! => {[0m
[0;31m    "assertion": "not rhel9cis_ansible_user_password_set.stdout.startswith(\"!\")",[0m
[0;31m    "changed": false,[0m
[0;31m    "evaluated_to": false,[0m
[0;31m    "msg": "You have rhel9cis_rule_5_3_4 enabled but the user = ec2-user is locked - It can break access"[0m
[0;31m}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : Ensure root password is set] *********************************
[0;32mok: [node][0m

TASK [RHEL9-CIS : Ensure root password is set] *********************************
[0;32mok: [node] => {[0m
[0;32m    "changed": false,[0m
[0;32m    "msg": "You have a root password set"[0m
[0;32m}[0m

TASK [RHEL9-CIS : Discover and set container variable if required] *************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Load variable for container] *********************************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Output if discovered is a container] *************************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Check crypto-policy input] ***********************************
[0;32mok: [node] => {[0m
[0;32m    "changed": false,[0m
[0;32m    "msg": "Crypto policy is a permitted version"[0m
[0;32m}[0m

TASK [RHEL9-CIS : Check crypto-policy module input] ****************************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Check rhel9cis_bootloader_password_hash variable has been changed] ***
[0;31mfatal: [node]: FAILED! => {[0m
[0;31m    "assertion": "rhel9cis_bootloader_password_hash.find('grub.pbkdf2.sha512') != -1 and rhel9cis_bootloader_password_hash != 'grub.pbkdf2.sha512.changethispassword'",[0m
[0;31m    "changed": false,[0m
[0;31m    "evaluated_to": false,[0m
[0;31m    "msg": "This role will not be able to run single user password commands as rhel9cis_bootloader_password_hash variable has not been set correctly"[0m
[0;31m}[0m
[0;36m...ignoring[0m

TASK [RHEL9-CIS : Gather the package facts] ************************************
[0;32mok: [node][0m

TASK [RHEL9-CIS : Include OS specific variables] *******************************
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Include audit specific variables] *******************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit Setup | Setup the LE audit] ************************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit Setup | Ensure {{ audit_conf_dir }} exists] ********
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit Setup | Install git] *******************************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit Setup | Retrieve audit content files from git] *****
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit Setup | Copy to audit content files to server] *****
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit Setup | Unarchive audit content files on server] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit Setup | Get audit content from url] ****************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit Setup | Check for goss file] ***********************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit Setup | If audit ensure goss is available] *********
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit Setup | Copy ansible default vars values to test audit] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit | Run pre_remediation RHEL9-CIS audit] *************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit | Capture audit data if json format] ***************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit | Set Fact for audit summary] **********************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit | Capture audit data if documentation format] ******
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Pre Audit | Set Fact for audit summary] **********************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Audit_Only | Create local Directories for hosts] *************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Audit_only | Get audits from systems and put in group dir] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Audit_only | Show Audit Summary] *****************************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : Audit_only | Stop Playbook Audit Only selected] **************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : PRELIM | AUDIT | Interactive Users] **************************
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | AUDIT | Interactive User accounts home directories] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | AUDIT | Interactive UIDs] ***************************
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | capture /etc/password variables] ********************
[0;36mincluded: /Users/meesam/.ansible/roles/RHEL9-CIS/tasks/parse_etc_password.yml for node[0m

TASK [RHEL9-CIS : PRELIM | 5.5.2 | 6.2.7 | 6.2.8 | 6.2.20 | Parse /etc/passwd] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | 5.5.2 | 6.2.7 | 6.2.8 | 6.2.20 | Split passwd entries] ***
[0;32mok: [node] => (item=root:x:0:0:root:/root:/bin/bash)[0m
[0;32mok: [node] => (item=bin:x:1:1:bin:/bin:/sbin/nologin)[0m
[0;32mok: [node] => (item=daemon:x:2:2:daemon:/sbin:/sbin/nologin)[0m
[0;32mok: [node] => (item=adm:x:3:4:adm:/var/adm:/sbin/nologin)[0m
[0;32mok: [node] => (item=lp:x:4:7:lp:/var/spool/lpd:/sbin/nologin)[0m
[0;32mok: [node] => (item=sync:x:5:0:sync:/sbin:/bin/sync)[0m
[0;32mok: [node] => (item=shutdown:x:6:0:shutdown:/sbin:/sbin/shutdown)[0m
[0;32mok: [node] => (item=halt:x:7:0:halt:/sbin:/sbin/halt)[0m
[0;32mok: [node] => (item=mail:x:8:12:mail:/var/spool/mail:/sbin/nologin)[0m
[0;32mok: [node] => (item=operator:x:11:0:operator:/root:/sbin/nologin)[0m
[0;32mok: [node] => (item=games:x:12:100:games:/usr/games:/sbin/nologin)[0m
[0;32mok: [node] => (item=ftp:x:14:50:FTP User:/var/ftp:/sbin/nologin)[0m
[0;32mok: [node] => (item=nobody:x:65534:65534:Kernel Overflow User:/:/sbin/nologin)[0m
[0;32mok: [node] => (item=dbus:x:81:81:System message bus:/:/sbin/nologin)[0m
[0;32mok: [node] => (item=systemd-coredump:x:999:997:systemd Core Dumper:/:/sbin/nologin)[0m
[0;32mok: [node] => (item=systemd-resolve:x:193:193:systemd Resolver:/:/sbin/nologin)[0m
[0;32mok: [node] => (item=tss:x:59:59:Account used for TPM access:/dev/null:/sbin/nologin)[0m
[0;32mok: [node] => (item=polkitd:x:998:996:User for polkitd:/:/sbin/nologin)[0m
[0;32mok: [node] => (item=unbound:x:997:994:Unbound DNS resolver:/etc/unbound:/sbin/nologin)[0m
[0;32mok: [node] => (item=sssd:x:996:993:User for sssd:/:/sbin/nologin)[0m
[0;32mok: [node] => (item=chrony:x:995:992::/var/lib/chrony:/sbin/nologin)[0m
[0;32mok: [node] => (item=sshd:x:74:74:Privilege-separated SSH:/var/empty/sshd:/sbin/nologin)[0m
[0;32mok: [node] => (item=ec2-user:x:1000:1000:ec2-user:/home/ec2-user:/bin/bash)[0m
[0;32mok: [node] => (item=systemd-oom:x:990:990:systemd Userspace OOM Killer:/:/usr/sbin/nologin)[0m

TASK [RHEL9-CIS : PRELIM | List users accounts] ********************************
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Gather accounts with empty password fields] *********
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Gather UID 0 accounts other than root] **************
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Install crypto-policies | pkgs present] *************
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Gather system-wide crypto-policy] *******************
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Gather system-wide crypto-policy | set fact system policy] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Gather system-wide crypto-policy module | set fact system policy submodule] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : PRELIM | if systemd coredump] ********************************
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Section 1.1 | Create list of mount points] **********
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Ensure python3-libselinux is installed] *************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : PRELIM | Check whether machine is UEFI-based] ****************
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | set legacy boot and grub path | Bios] ***************
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | set grub fact | UEFI] *******************************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : PRELIM | Update to latest gpg keys] **************************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : PRELIM | Check gpg keys are imported will cause 1.2.1 to fail if not] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : PRELIM | Check key package matches RedHat] *******************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : PRELIM | Force keys to be imported] **************************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : PRELIM | Section 4.1 | Configure System Accounting (auditd)] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | 4.1.4.5 | Audit conf and rules files | list files] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Section 5.1 | Configure cron] ***********************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : PRELIM | Section 5.2 | SSH] **********************************
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : PRELIM | 5.3.4 | Find all sudoers files.] ********************
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Capture UID_MIN information from logins.def] ********
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Capture UID_MAX information from logins.def] ********
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Capture GID_MIN information from logins.def] ********
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | set_facts for interactive uid/gid] ******************
[0;32mok: [node][0m

TASK [RHEL9-CIS : PRELIM | Output of uid findings] *****************************
[0;32mok: [node] => {[0m
[0;32m    "msg": "1000 60000"[0m
[0;32m}[0m

TASK [RHEL9-CIS : PRELIM | Gather the package facts after prelim] **************
[0;32mok: [node][0m

TASK [RHEL9-CIS : 1.1.1.1 | PATCH | Ensure mounting of squashfs filesystems is disabled | Edit modprobe config] ***
[0;33mchanged: [node][0m

TASK [RHEL9-CIS : 1.1.1.1 | PATCH | Ensure mounting of squashfs filesystems is disabled | blacklist] ***
[0;33mchanged: [node][0m

TASK [RHEL9-CIS : 1.1.1.1 | PATCH | Ensure mounting of squashfs filesystems is disabled | Disable squashfs] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 1.1.1.2 | PATCH | Ensure mounting of udf filesystems is disable | Edit modprobe config] ***
[0;33mchanged: [node][0m

TASK [RHEL9-CIS : 1.1.1.2 | PATCH | Ensure mounting of udf filesystems is disabled | blacklist] ***
[0;33mchanged: [node][0m

TASK [RHEL9-CIS : 1.1.1.2 | PATCH | Ensure mounting of udf filesystems is disable | Disable udf] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 1.1.2.1 | PATCH | Ensure /tmp is a separate partition | Absent] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": "Warning!! /tmp doesn't exist. This is a manual task"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 1.1.2.1 | AUDIT | Set fact for manual task warning.] *********
[0;32mok: [node][0m

TASK [RHEL9-CIS : "1.1.2.2 | PATCH | Ensure nodev option set on /tmp partition"
"1.1.2.3 | PATCH | Ensure noexec option set on /tmp partition"
"1.1.2.4 | PATCH | Ensure nosuid option set on /tmp partition"] ***
[0;36mskipping: [node] => (item=/dev/mapper/ol-root) [0m
[0;36mskipping: [node] => (item=/dev/nvme0n1p2) [0m
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : "1.1.2.1 | PATCH | Ensure /tmp is configured"
"1.1.2.2 | PATCH | Ensure nodev option set on /tmp partition"
"1.1.2.3 | PATCH | Ensure noexec option set on /tmp partition"
"1.1.2.4 | PATCH | Ensure nosuid option set on /tmp partition"] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.1.3.1 | AUDIT | Ensure separate partition exists for /var | Absent] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": "Warning!! /var doesn't exist. This is a manual task"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 1.1.3.1 | AUDIT | Set fact for manual task warning.] *********
[0;32mok: [node][0m

TASK [RHEL9-CIS : "1.1.3.2 | PATCH | Ensure nodev option set on /var partition"
"1.1.3.3 | PATCH | Ensure nosuid option set on /var partition"] ***
[0;36mskipping: [node] => (item=/dev/mapper/ol-root) [0m
[0;36mskipping: [node] => (item=/dev/nvme0n1p2) [0m
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.1.4.1 | AUDIT | Ensure separate partition exists for /var/tmp | Absent] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": "Warning!! /var/tmp doesn't exist. This is a manual task"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 1.1.4.1 | AUDIT | Set fact for manual task warning.] *********
[0;32mok: [node][0m

TASK [RHEL9-CIS : "1.1.4.2 | PATCH | Ensure noexec option set on /var/tmp partition"
"1.1.4.3 | PATCH | Ensure nosuid option set on /var/tmp partition"
"1.1.4.4 | PATCH | Ensure nodev option set on /var/tmp partition"] ***
[0;36mskipping: [node] => (item=/dev/mapper/ol-root) [0m
[0;36mskipping: [node] => (item=/dev/nvme0n1p2) [0m
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.1.5.1 | AUDIT | Ensure separate partition exists for /var/log | Absent] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": "Warning!! /var/log doesn't exist. This is a manual task"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 1.1.5.1 | AUDIT | Set fact for manual task warning.] *********
[0;32mok: [node][0m

TASK [RHEL9-CIS : "1.1.5.2 | PATCH | Ensure nodev option set on /var/log partition"
"1.1.5.3 | PATCH | Ensure noexec option set on /var/log partition"
"1.1.5.4 | PATCH | Ensure nosuid option set on /var/log partition"] ***
[0;36mskipping: [node] => (item=/dev/mapper/ol-root) [0m
[0;36mskipping: [node] => (item=/dev/nvme0n1p2) [0m
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.1.6.1 | AUDIT | Ensure separate partition exists for /var/log/audit | Absent] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": "Warning!! /var/log/audit doesn't exist. This is a manual task"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 1.1.6.1 | AUDIT | Set fact for manual task warning.] *********
[0;32mok: [node][0m

TASK [RHEL9-CIS : "1.1.6.2 | PATCH | Ensure noexec option set on /var/log/audit partition"
"1.1.6.3 | PATCH | Ensure nodev option set on /var/log/audit partition"
"1.1.6.4 | PATCH | Ensure nosuid option set on /var/log/audit partition"] ***
[0;36mskipping: [node] => (item=/dev/mapper/ol-root) [0m
[0;36mskipping: [node] => (item=/dev/nvme0n1p2) [0m
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.1.7.1 | AUDIT | Ensure separate partition exists for /home | Absent] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": "Warning!! /home doesn't exist. This is a manual task"[0m
[0;32m}[0m

TASK [RHEL9-CIS : 1.1.7.1 | AUDIT | Set fact for manual task warning.] *********
[0;32mok: [node][0m

TASK [RHEL9-CIS : "1.1.7.2 | PATCH | Ensure nodev option set on /home partition
 1.1.7.3 | PATCH | Ensure nosuid option set on /home partition"] ***
[0;36mskipping: [node] => (item=/dev/mapper/ol-root) [0m
[0;36mskipping: [node] => (item=/dev/nvme0n1p2) [0m
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.1.8.1 | AUDIT | Ensure /dev/shm is a separate partition | check exists] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 1.1.8.1 | AUDIT | Ensure /dev/shm is a separate partition | Absent] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.1.8.1 | AUDIT | Set fact for manual task warning.] *********
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : "1.1.8.2 | PATCH | Ensure nodev option set on /dev/shm partition | Set nodev option
 1.1.8.3 | PATCH | Ensure noexec option set on /dev/shm partition | Set nosuid option
 1.1.8.4 | PATCH | Ensure nosuid option set on /dev/shm partition | Set noexec option"] ***
[0;33mchanged: [node][0m

TASK [RHEL9-CIS : 1.1.9 | PATCH | Disable USB Storage | Edit modprobe config] ***
[0;33mchanged: [node][0m

TASK [RHEL9-CIS : 1.1.9 | PATCH | Disable USB Storage | Edit modprobe config] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 1.1.9 | PATCH | Disable USB Storage | blacklist] *************
[0;33mchanged: [node][0m

TASK [RHEL9-CIS : 1.2.1 | AUDIT | Ensure GPG keys are configured | list installed pubkey keys] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.2.1 | AUDIT | Ensure GPG keys are configured | Query found keys] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.2.1 | AUDIT | Ensure GPG keys are configured | expected keys fail] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.2.2 | AUDIT | Ensure gpgcheck is globally activated | Find repos] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 1.2.2 | PATCH | Ensure gpgcheck is globally activated | Update yum.repos] ***
[0;32mok: [node] => (item=/etc/yum.repos.d/virt-ol9.repo)[0m
[0;32mok: [node] => (item=/etc/yum.repos.d/oracle-linux-ol9.repo)[0m
[0;32mok: [node] => (item=/etc/yum.repos.d/uek-ol9.repo)[0m

TASK [RHEL9-CIS : 1.2.3 | AUDIT | Ensure package manager repositories are configured | Get repo list] ***
[0;32mok: [node][0m

TASK [RHEL9-CIS : 1.2.3 | AUDIT | Ensure package manager repositories are configured | Display repo list] ***
[0;32mok: [node] => {[0m
[0;32m    "msg": [[0m
[0;32m        "Warning!! Below are the configured repos. Please review and make sure all align with site policy",[0m
[0;32m        [[0m
[0;32m            "repo id                repo name",[0m
[0;32m            "ol9_UEKR7              Oracle Linux 9 UEK Release 7 (x86_64)",[0m
[0;32m            "ol9_appstream          Oracle Linux 9 Application Stream Packages (x86_64)",[0m
[0;32m            "ol9_baseos_latest      Oracle Linux 9 BaseOS Latest (x86_64)"[0m
[0;32m        ][0m
[0;32m    ][0m
[0;32m}[0m

TASK [RHEL9-CIS : 1.2.3 | AUDIT | Set fact for manual task warning.] ***********
[0;32mok: [node][0m

TASK [RHEL9-CIS : 1.2.4 | PATCH | Ensure repo_gpgcheck is globally activated | dnf.conf] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.2.4 | AUDIT| Ensure repo_gpgcheck is globally activated | get repo files] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.2.4 | PATCH | Ensure repo_gpgcheck is globally activated | amend repo files] ***
[0;36mskipping: [node][0m

TASK [RHEL9-CIS : 1.3.1 | PATCH | Ensure AIDE is installed | Install AIDE] *****
[0;33mchanged: [node][0m

TASK [RHEL9-CIS : 1.3.1 | PATCH | Ensure AIDE is installed | Build AIDE DB] ****
